<!DOCTYPE html>
<html lang="zh-CN">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='数据库介绍 什么是数据库?
​	数据库是为了实现一定的目的按某种规则组织起来的数据的集合, 简单的说,数据库就是存储数据的库.
​	举个例子来说明这个问题：每个人都有很多亲戚和朋友，为了保持与他们的联系，
​	我们常常用一个笔记本将他们的姓名、地址、电话等信息都记录下来，
​	这样要査谁的电话或地址就很方便了。
​	这个“通讯录”就是一个最简单的“数据库”，每个人的姓名、地址、电话等信息就是这个数据库中的“数据”。
​	我们可以在笔记本这个“数据库”中添加新朋友的个人信息，也可以由于某个朋友的电话变动而修改他的电话号码这个“数据”。
​	不过说到底，我们使用笔记本这个“数据库”还是为了能随时査到某位亲戚或朋友的地址、邮编或电话号码这些“数据”。
数据库是干什么用的?
存储和管理数据,便于程序开发.
oracle简介:
Oracle是殷墟（yīn Xu）出土的甲骨文（oracle bone inscriptions）的英文翻译的第一个单词。
Oracle公司成立与1977年，总部位于美国加州；
Oracle数据库是Oracle（中文名称叫甲骨文）公司的核心产品，Oracle数据库是一个适合于大中型企业的数据库管理系统。在所有的数据库管理系统中（比如：微软的SQL Server，IBM的DB2等），Oracle的主要用户涉及面非常广, 包括: 银行、电信、移动通信、航空、保险、金融、电子商务和跨国公司等。
Oracle数据库的一些版本有：Oracle7、Oracle8i、Oracle9i，Oracle10g到Oracle11g，Oracle12c， 各个版本之间的操作存在一定的差别，但是操作oracle数据库都使用的是标准的SQL语句，因此对于各个版本的差别不大。
2008年1月16日 收购bea，目的是为了得到weblogic（web服务器的框架，免费的对应的tomcat）。
2008年1月16日 sun公司收购了mysql 。
2009年4月20日 oracle收购了sun 。
常见的数据库有哪些？
oracle公司的oracle数据库
IBM公司的DB2数据库
Informix公司的Informix数据库
sysbase公司的sysbase数据库
Microsoft公司的SQL Server
oracle的MySQL数据库（开始属于mysql公司，后来mysql被sun收购，sun又被oracle收购）
MongoDB数据库
Mariadb数据库 (由MySQL的创始人Michael Widenius（英语：Michael Widenius）主导开发,MariaDB名称来自Michael Widenius的女儿Maria的名字)
SQLite (设计目标是嵌入式)
1 Oracle的体系结构 Oracle服务器：是一个数据管理系统(RDBMS)，它提供开放的, 全面的, 近乎完整的信息管理。由1个数据库和一个（或多个）实例组成。数据库位于硬盘上，实例位于内存中。
img 1.1 表空间和数据文件 逻辑概念：表空间是由数据文件组成，位于实例上，在内存中。
物理概念：数据文件，在磁盘上（/home/oracle_11/app/oradata/orcl目录中的.DBF文件）；
​ 一个表空间包含一个或者多个数据文件。
1.2 段、区、块 img 段存在于表空间中，段是区的集合，区是数据块的集合，数据块会被映射到磁盘块。'><title>Oracle数据库介绍</title>

<link rel='canonical' href='https://okokfun.github.io/post/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Oracle数据库介绍'>
<meta property='og:description' content='数据库介绍 什么是数据库?
​	数据库是为了实现一定的目的按某种规则组织起来的数据的集合, 简单的说,数据库就是存储数据的库.
​	举个例子来说明这个问题：每个人都有很多亲戚和朋友，为了保持与他们的联系，
​	我们常常用一个笔记本将他们的姓名、地址、电话等信息都记录下来，
​	这样要査谁的电话或地址就很方便了。
​	这个“通讯录”就是一个最简单的“数据库”，每个人的姓名、地址、电话等信息就是这个数据库中的“数据”。
​	我们可以在笔记本这个“数据库”中添加新朋友的个人信息，也可以由于某个朋友的电话变动而修改他的电话号码这个“数据”。
​	不过说到底，我们使用笔记本这个“数据库”还是为了能随时査到某位亲戚或朋友的地址、邮编或电话号码这些“数据”。
数据库是干什么用的?
存储和管理数据,便于程序开发.
oracle简介:
Oracle是殷墟（yīn Xu）出土的甲骨文（oracle bone inscriptions）的英文翻译的第一个单词。
Oracle公司成立与1977年，总部位于美国加州；
Oracle数据库是Oracle（中文名称叫甲骨文）公司的核心产品，Oracle数据库是一个适合于大中型企业的数据库管理系统。在所有的数据库管理系统中（比如：微软的SQL Server，IBM的DB2等），Oracle的主要用户涉及面非常广, 包括: 银行、电信、移动通信、航空、保险、金融、电子商务和跨国公司等。
Oracle数据库的一些版本有：Oracle7、Oracle8i、Oracle9i，Oracle10g到Oracle11g，Oracle12c， 各个版本之间的操作存在一定的差别，但是操作oracle数据库都使用的是标准的SQL语句，因此对于各个版本的差别不大。
2008年1月16日 收购bea，目的是为了得到weblogic（web服务器的框架，免费的对应的tomcat）。
2008年1月16日 sun公司收购了mysql 。
2009年4月20日 oracle收购了sun 。
常见的数据库有哪些？
oracle公司的oracle数据库
IBM公司的DB2数据库
Informix公司的Informix数据库
sysbase公司的sysbase数据库
Microsoft公司的SQL Server
oracle的MySQL数据库（开始属于mysql公司，后来mysql被sun收购，sun又被oracle收购）
MongoDB数据库
Mariadb数据库 (由MySQL的创始人Michael Widenius（英语：Michael Widenius）主导开发,MariaDB名称来自Michael Widenius的女儿Maria的名字)
SQLite (设计目标是嵌入式)
1 Oracle的体系结构 Oracle服务器：是一个数据管理系统(RDBMS)，它提供开放的, 全面的, 近乎完整的信息管理。由1个数据库和一个（或多个）实例组成。数据库位于硬盘上，实例位于内存中。
img 1.1 表空间和数据文件 逻辑概念：表空间是由数据文件组成，位于实例上，在内存中。
物理概念：数据文件，在磁盘上（/home/oracle_11/app/oradata/orcl目录中的.DBF文件）；
​ 一个表空间包含一个或者多个数据文件。
1.2 段、区、块 img 段存在于表空间中，段是区的集合，区是数据块的集合，数据块会被映射到磁盘块。'>
<meta property='og:url' content='https://okokfun.github.io/post/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D/'>
<meta property='og:site_name' content='My Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Oracle' /><meta property='article:published_time' content='2022-01-09T16:51:29&#43;00:00'/><meta property='article:modified_time' content='2022-01-09T16:51:29&#43;00:00'/>
<meta name="twitter:title" content="Oracle数据库介绍">
<meta name="twitter:description" content="数据库介绍 什么是数据库?
​	数据库是为了实现一定的目的按某种规则组织起来的数据的集合, 简单的说,数据库就是存储数据的库.
​	举个例子来说明这个问题：每个人都有很多亲戚和朋友，为了保持与他们的联系，
​	我们常常用一个笔记本将他们的姓名、地址、电话等信息都记录下来，
​	这样要査谁的电话或地址就很方便了。
​	这个“通讯录”就是一个最简单的“数据库”，每个人的姓名、地址、电话等信息就是这个数据库中的“数据”。
​	我们可以在笔记本这个“数据库”中添加新朋友的个人信息，也可以由于某个朋友的电话变动而修改他的电话号码这个“数据”。
​	不过说到底，我们使用笔记本这个“数据库”还是为了能随时査到某位亲戚或朋友的地址、邮编或电话号码这些“数据”。
数据库是干什么用的?
存储和管理数据,便于程序开发.
oracle简介:
Oracle是殷墟（yīn Xu）出土的甲骨文（oracle bone inscriptions）的英文翻译的第一个单词。
Oracle公司成立与1977年，总部位于美国加州；
Oracle数据库是Oracle（中文名称叫甲骨文）公司的核心产品，Oracle数据库是一个适合于大中型企业的数据库管理系统。在所有的数据库管理系统中（比如：微软的SQL Server，IBM的DB2等），Oracle的主要用户涉及面非常广, 包括: 银行、电信、移动通信、航空、保险、金融、电子商务和跨国公司等。
Oracle数据库的一些版本有：Oracle7、Oracle8i、Oracle9i，Oracle10g到Oracle11g，Oracle12c， 各个版本之间的操作存在一定的差别，但是操作oracle数据库都使用的是标准的SQL语句，因此对于各个版本的差别不大。
2008年1月16日 收购bea，目的是为了得到weblogic（web服务器的框架，免费的对应的tomcat）。
2008年1月16日 sun公司收购了mysql 。
2009年4月20日 oracle收购了sun 。
常见的数据库有哪些？
oracle公司的oracle数据库
IBM公司的DB2数据库
Informix公司的Informix数据库
sysbase公司的sysbase数据库
Microsoft公司的SQL Server
oracle的MySQL数据库（开始属于mysql公司，后来mysql被sun收购，sun又被oracle收购）
MongoDB数据库
Mariadb数据库 (由MySQL的创始人Michael Widenius（英语：Michael Widenius）主导开发,MariaDB名称来自Michael Widenius的女儿Maria的名字)
SQLite (设计目标是嵌入式)
1 Oracle的体系结构 Oracle服务器：是一个数据管理系统(RDBMS)，它提供开放的, 全面的, 近乎完整的信息管理。由1个数据库和一个（或多个）实例组成。数据库位于硬盘上，实例位于内存中。
img 1.1 表空间和数据文件 逻辑概念：表空间是由数据文件组成，位于实例上，在内存中。
物理概念：数据文件，在磁盘上（/home/oracle_11/app/oradata/orcl目录中的.DBF文件）；
​ 一个表空间包含一个或者多个数据文件。
1.2 段、区、块 img 段存在于表空间中，段是区的集合，区是数据块的集合，数据块会被映射到磁盘块。"><script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>


    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/post/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D/">Oracle数据库介绍</a>
    </h2>

    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 09, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    23 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <!-- raw HTML omitted -->
<h2 id="数据库介绍">数据库介绍</h2>
<p>什么是数据库?</p>
<p>​	数据库是为了实现一定的目的按某种规则组织起来的数据的集合, 简单的说,数据库就是存储数据的库.</p>
<p>​	举个例子来说明这个问题：每个人都有很多亲戚和朋友，为了保持与他们的联系，</p>
<p>​	我们常常用一个笔记本将他们的姓名、地址、电话等信息都记录下来，</p>
<p>​	这样要査谁的电话或地址就很方便了。</p>
<p>​	这个“通讯录”就是一个最简单的“数据库”，每个人的姓名、地址、电话等信息就是这个数据库中的“数据”。</p>
<p>​	我们可以在笔记本这个“数据库”中添加新朋友的个人信息，也可以由于某个朋友的电话变动而修改他的电话号码这个“数据”。</p>
<p>​	不过说到底，我们使用笔记本这个“数据库”还是为了能随时査到某位亲戚或朋友的地址、邮编或电话号码这些“数据”。</p>
<p>数据库是干什么用的?</p>
<p>存储和管理数据,便于程序开发.</p>
<p>oracle简介:</p>
<p>Oracle是殷墟（yīn Xu）出土的甲骨文（oracle bone inscriptions）的英文翻译的第一个单词。</p>
<p>Oracle公司成立与1977年，总部位于美国加州；</p>
<p>Oracle数据库是Oracle（中文名称叫甲骨文）公司的核心产品，Oracle数据库是一个适合于大中型企业的数据库管理系统。在所有的数据库管理系统中（比如：微软的SQL Server，IBM的DB2等），Oracle的主要用户涉及面非常广, 包括: 银行、电信、移动通信、航空、保险、金融、电子商务和跨国公司等。</p>
<p>Oracle数据库的一些版本有：Oracle7、Oracle8i、Oracle9i，Oracle10g到Oracle11g，Oracle12c， 各个版本之间的操作存在一定的差别，但是操作oracle数据库都使用的是标准的SQL语句，因此对于各个版本的差别不大。</p>
<p>2008年1月16日 收购bea，目的是为了得到weblogic（web服务器的框架，免费的对应的tomcat）。</p>
<p>2008年1月16日 sun公司收购了mysql 。</p>
<p>2009年4月20日 oracle收购了sun 。</p>
<p>常见的数据库有哪些？</p>
<ol>
<li>
<p>oracle公司的oracle数据库</p>
</li>
<li>
<p>IBM公司的DB2数据库</p>
</li>
<li>
<p>Informix公司的Informix数据库</p>
</li>
<li>
<p>sysbase公司的sysbase数据库</p>
</li>
<li>
<p>Microsoft公司的SQL Server</p>
</li>
<li>
<p>oracle的MySQL数据库（开始属于mysql公司，后来mysql被sun收购，sun又被oracle收购）</p>
</li>
<li>
<p><a class="link" href="https://baike.baidu.com/item/MongoDB%e6%9d%83%e5%a8%81%e6%8c%87%e5%8d%97/7338398"  target="_blank" rel="noopener"
    >MongoDB</a>数据库</p>
</li>
<li>
<p>Mariadb数据库 (由MySQL的创始人Michael Widenius（英语：Michael Widenius）主导开发,MariaDB名称来自Michael Widenius的女儿Maria的名字)</p>
</li>
<li>
<p>SQLite (设计目标是<a class="link" href="https://baike.baidu.com/item/%e5%b5%8c%e5%85%a5%e5%bc%8f/575465"  target="_blank" rel="noopener"
    >嵌入式</a>)</p>
</li>
</ol>
<h2 id="1-oracle的体系结构">1 Oracle的体系结构</h2>
<p>Oracle服务器：是一个数据管理系统(RDBMS)，它提供开放的, 全面的, 近乎完整的信息管理。由1个数据库和一个（或多个）实例组成。数据库位于硬盘上，实例位于内存中。</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps1.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps1.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<h3 id="11-表空间和数据文件">1.1 表空间和数据文件</h3>
<p>逻辑概念：表空间是由数据文件组成，位于实例上，在内存中。</p>
<p>物理概念：数据文件，在磁盘上（<code>/home/oracle_11/app/oradata/orcl</code>目录中的<code>.DBF</code>文件）；</p>
<p>​     一个表空间包含一个或者多个数据文件。</p>
<h3 id="12-段区块">1.2 段、区、块</h3>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps2.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps2.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<p>段存在于表空间中，段是区的集合，区是数据块的集合，数据块会被映射到磁盘块。</p>
<p>图请看讲义部分。</p>
<h3 id="13-dba">1.3 DBA</h3>
<p>数据库管理员（Database Administrator，简称DBA），是从事管理和维护<a class="link" href="https://baike.baidu.com/item/%e6%95%b0%e6%8d%ae%e5%ba%93%e7%ae%a1%e7%90%86%e7%b3%bb%e7%bb%9f"  target="_blank" rel="noopener"
    >数据库管理系统</a>(DBMS)的相关工作人员的统称，属于<a class="link" href="https://baike.baidu.com/item/%e8%bf%90%e7%bb%b4%e5%b7%a5%e7%a8%8b%e5%b8%88"  target="_blank" rel="noopener"
    >运维工程师</a>的一个分支，主要负责业务数据库从设计、测试到部署交付的全生命周期管理。DBA的核心目标是保证数据库管理系统的稳定性、安全性、完整性和高性能。从时间开销上看：安装占用6%，创建和配置占用12%，装载和存档数据占6%, 软件维护占6%，管理数据库系统占55%，可见，管理数据库系统占用了大部分的时间开销。</p>
<h3 id="14-如何启动数据库服务">1.4 如何启动数据库服务</h3>
<p>Windows启动oracle数据库服务：</p>
<p>启动服务：<code>services.msc</code>，找到下列两个服务，并启动。</p>
<p><code>OracleServiceORCL： oracle</code>数据库服务系统</p>
<p>home1TNSListene： 监听服务，用于远程连接的侦听</p>
<p>注意：若把数据库默认设置为自启动，则开机时间会延长。</p>
<p>Linux启动oracle数据库服务步骤(oracle数据库系统安装到linux系统上)</p>
<p>​	1.  执行<code>sqlplus / as sysdba</code>或<code>sqlplus sys/sys as sysdba</code>进入到命令行界面</p>
<p>​	2. 执行startup启动数据库服务</p>
<p>​	3. 执行exit退出sqlplus命令行界面</p>
<p>​	4. 执行<code>lsnrctl start</code>启动监听服务</p>
<p>注意：通过远程客户端连接oracle服务端必须要启动监听服务，否则客户端连接不上。</p>
<h3 id="15-如何登陆数据库服务">1.5 如何登陆数据库服务</h3>
<p>在本机登陆：</p>
<p>普通用户身份登陆</p>
<p>sqlplus  ↙ 用户名 ↙	密码 ↙</p>
<p>sqlplus 用户名/密码，如<code>sqlplus scott/tiger</code></p>
<ol>
<li>以管理员身份登陆</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>sqlplus  <span style="color:#f92672">/</span>  <span style="color:#66d9ef">as</span>  sysdba<span style="color:#960050;background-color:#1e0010">（此处不用输入密码，在安装的时候已经输入密码）</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sqlplus sys<span style="color:#f92672">/</span>sys <span style="color:#66d9ef">as</span> sysdba
</span></span></code></pre></div><ol start="2">
<li>通过网络使用客户端远程登陆</li>
</ol>
<p>远程通过网络登陆数据库需要安装oracle客户端软件，并进行配置才能使用，可通过使用net manager进行配置，配置完成之后可以使用连接字符串进行登陆，连接字符串中包含了数据库服务的IP地址和端口，以及实例名。</p>
<p>注意：安装oracle客户端的时候，安装路径中不能出现中文和空格，安装的时候选择管理员模式。</p>
<p><code>D:\oracle\app\HGUANG\product\11.2.0\client_1\network\admin\tnsnames.ora</code>，下面是经过<code>Net Manager</code>进行配置后得到的一个文件内容：</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps3.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps3.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<p>客户端安装完成之后进行远程登陆之前最好先进行测试：</p>
<p>首先测试网络是否是通的： ping  IP ， 然后tnsping  IP  或者 tnsping oracle_orcl。</p>
<p>普通用户登陆</p>
<p>sqlplus 用户名/密码@连接字符串，如<code>sqlplus scott/tiger@oracle_orcl</code></p>
<p>管理员用户登陆</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sqlplus sys/sys@oracle_orcl as sysdba
</span></span></code></pre></div><p>此外：还可以执行： <code>sqlplus scott/tiger@//IP地址/实例名</code>     进行登陆。</p>
<p>使用scott用户或者sys用户登陆完之后，可以使用<code>show user</code>测试一下，如果显示用户名就表明已经登陆成功了，或者是执行<code>select * from tab;</code>进行一次查询, 有结果显示就表名已经登陆成功了.</p>
<p>解锁用户：<code>alter user scott account unlock</code> (管理员身份登陆，给scott用户解锁。用户默认锁定)</p>
<p>锁定用户：<code>alter user scott account lock</code>，（必须用管理员用户登陆）</p>
<p>修改用户密码：<code>alter user scott identified by 新密码</code>   (管理员身份登陆，给scott用户修改密码)</p>
<p>查看当前语言环境：<code>select userenv('language') from dual</code>;</p>
<h3 id="16-贯穿这门课程的方案">1.6 贯穿这门课程的方案</h3>
<p>请看oracle讲义。</p>
<p><code>scott用户</code>的<code>emp表</code>, <code>dept表</code>和<code>salgrade表</code>.</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps4.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps4.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<h2 id="2基本的sql-select语句">2基本的SQL select语句</h2>
<h3 id="21-sqlplus的基本操作">2.1 sqlplus的基本操作</h3>
<p>显示当前用户： <code>show user</code>;</p>
<p>查看当前用户下的表：<code>select * from tab</code>;</p>
<p>​	tab:	数据字典（记录<a class="link" href="http://baike.baidu.com/view/1088.htm"  target="_blank" rel="noopener"
    >数据库</a>和<a class="link" href="http://baike.baidu.com/view/330120.htm"  target="_blank" rel="noopener"
    >应用程序</a>源数据的目录），包含当前用户下的表。</p>
<p>查看员工表的结构：<code>desc emp</code>;</p>
<p>设置行宽：<code>set linesize 120</code>;</p>
<p>设置页面：<code>set pagesize 100</code>;</p>
<p>​	或者将上述两行写入如下两个配置文件，可永久设置：</p>
<p><code>C:\app\Administrator\product\11.2.0\client_1\sqlplus\admin\glogin.sql</code></p>
<p><code>C:\app\Administrator\product\11.2.0\dbhome_1\sqlplus\admin\glogin.sql</code></p>
<p>设置员工名列宽：<code>col ename for a20</code>			(a表示字符串)</p>
<p>设置薪水列为4位数子：<code>col sal for 9999</code>		(一个9表示一位数字)</p>
<h3 id="22-基本的select语句">2.2 基本的select语句</h3>
<p><code>Select语句</code>的整体形式：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> col1,
</span></span><span style="display:flex;"><span>         col2<span style="color:#960050;background-color:#1e0010">…</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> <span style="color:#66d9ef">table_name</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> condition
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  col<span style="color:#960050;background-color:#1e0010">…</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> condtion
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  col<span style="color:#960050;background-color:#1e0010">…</span>
</span></span></code></pre></div><p>其语法格式为：</p>
<p>SELECT  *|{[DISTINCT] *column|*expression [*alias],&hellip;} FROM *table;</p>
<p>案例</p>
<p>1查询所有员工的所有记录</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         job,
</span></span><span style="display:flex;"><span>         mgr,
</span></span><span style="display:flex;"><span>         hiredate,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         comm,
</span></span><span style="display:flex;"><span>         deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>说明：尽量使用列名，用列名代替* (oracle 9i之前不同， 之后一样)</p>
<p>2 查询员工号、姓名、薪水</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         sal
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>3 查询员工号、姓名、薪水和年薪</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>说明：select语句中可以使用表达式</p>
<p>注意：在执行sql语句的时候，执行 / 会执行上一次执行的语句。</p>
<p>若在写sql语句的时候, 写错了, 可以使用c（change）命令来修改. 默认, 光标闪烁位置指向上一条SQL语句的第一行。输入 2 则定位到第二行。</p>
<p>c  /错误关键字/正确关键字 ↙</p>
<p>使用“/”来执行修改过的SQL语句</p>
<p>例如：错误输入:</p>
<p>`select empno, ename, sal, sal * 12</p>
<p>​						  form emp`;  （“from”书写错误，该错误位于整条SQL语句的第二行）</p>
<p>（1） 输入：2↙  终端提示：2* from emp</p>
<p>（2） 输入：c  /form/from ↙		终端提示：2* from emp (意为改正后的sql语句样子)</p>
<p>（3） 输入：/↙</p>
<p>也可以使用ed(或者edit)命令来修改</p>
<p>ed ↙弹出系统默认的文本编辑器，(如记事本)</p>
<p>修改、保存、退出、执行“/”。</p>
<p>使用edit打开文件编辑sql语句:</p>
<p>如果sql语句很长, 可以分行编写或者用ed命令打开一个文件,</p>
<p>然后在文件中编写sql语句, 注意, sql语句末尾不要加;  , 然后换行加上/表示结束.</p>
<p>若想将显示结果保存到文件中:</p>
<p>spool命令:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>spool d:<span style="color:#ae81ff">\r</span>esult.txt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">select</span> * from emp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>spool off;
</span></span></code></pre></div><p>使用别名：</p>
<p>别名：as</p>
<p>案例：查询员工号，姓名，月薪，年薪</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> empno <span style="color:#66d9ef">AS</span> <span style="color:#e6db74">&#34;员工号&#34;</span>,
</span></span><span style="display:flex;"><span>         ename <span style="color:#e6db74">&#34;姓名&#34;</span>,
</span></span><span style="display:flex;"><span>         sal <span style="color:#960050;background-color:#1e0010">月薪</span>,
</span></span><span style="display:flex;"><span>         sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span> <span style="color:#960050;background-color:#1e0010">年薪</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>说明：关键字as写与不写没有区别； &ldquo;&ldquo;有与没有取决于别名中是否有空格，建议在用别名的时候加上&rdquo;&quot;。</p>
<p><code>DISTINCT</code>&mdash;à重复记录只取一次</p>
<p>案例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> job
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> job
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> deptno,
</span></span><span style="display:flex;"><span>         job
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>说明: <code>DISTINCT</code>的作用范围不是距离它最近的列, 而是后面的所有的列。</p>
<h3 id="23-sql语句使用注意事项">2.3 SQL语句使用注意事项</h3>
<ul>
<li>
<p>SQL 语言大小写不敏感。</p>
</li>
<li>
<p>sql语句对关键字的大小写不敏感, 如SELECT和select一样, 但是对于内容敏感。</p>
</li>
<li>
<p>SQL可以写在一行或者多行</p>
</li>
<li>
<p>关键字不能被缩写也不能分行</p>
</li>
<li>
<p>各子句一般要分行写。</p>
</li>
<li>
<p>使用缩进提高语句的可读性</p>
</li>
</ul>
<h3 id="24-算数运算-----">2.4 算数运算 + - * /</h3>
<p>乘除的优先级高于加减</p>
<p>优先级相同时, 按照从左至右运算</p>
<p>可以使用括号改变优先级</p>
<p>查询: 员工号、姓名、月薪、年薪、奖金、年收入。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span>,
</span></span><span style="display:flex;"><span>         comm,
</span></span><span style="display:flex;"><span>         comm<span style="color:#f92672">+</span>sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>​	结果不正确, 没有奖金的员工, 年收入不正确。</p>
<p>说明： 在程序开发过程中, 数据是核心. 程序再正确也没有用, 必须保证数据不能丢, 且正确, 对于上面的结果, 有对有错的情况是最危险的.</p>
<p>解决这个问题需要正确认识NULL值。</p>
<h3 id="25-null值">2.5 NULL值</h3>
<p>NULL值问题：</p>
<ol>
<li>
<p>包含NULL值的表达式都为空.</p>
</li>
<li>
<p>NULL不等于NULL</p>
</li>
</ol>
<p><code>select * from emp where NULL=NULL</code>; 查不到任何记录。</p>
<p>解决：滤空函数：nvl(a, b)  如果a为NULL，返回b；</p>
<p>所以：使用sal * 12 + nvl(comm, 0) 表示年收入。</p>
<ol start="3">
<li>在SQL中, 判断一值是否等于NULL不用“=” 和“!=”而使用is和is not</li>
</ol>
<p>查询奖金为NULL的员工信息：</p>
<p><code>select * from emp where comm = NULL</code>; (SQL中不使用==)</p>
<p>​		应该使用：<code>select * from emp where comm is NULL</code>;</p>
<p>查询奖金不为NULL的员工信息：</p>
<p><code>select * from emp where comm is not NULL</code>;</p>
<p>总结: 空值是无效的, 未指定的, 未知的或不可预知的值, 空值不是空格或者0.</p>
<h3 id="26-连接符">2.6 连接符</h3>
<p>​	在oracle中使用 || 连接字符串</p>
<p>例如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> ename <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39; is a &#39;</span> <span style="color:#f92672">||</span> job
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>若要显示hello world字符串应该怎么办呢?</p>
<p>oracle中语法规定：select后面必须接from关键字，所有需要有一个表名用来满足oracle的SQL99语法规定，为此定义了一个伪表dual。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> concat(<span style="color:#e6db74">&#39;hello &#39;</span>, <span style="color:#e6db74">&#39;world&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>若要连接三个字符串呢？</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> concat(concat(<span style="color:#e6db74">&#39;hello &#39;</span>, <span style="color:#e6db74">&#39;world&#39;</span>), <span style="color:#e6db74">&#39; i love you&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>注意：concat函数只支持两个参数，不支持三个参数形式。</p>
<p>​	也可以使用||连接三个以上的字符串：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#e6db74">&#39;hello &#39;</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;world &#39;</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;i love you&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>说明：使用||比concat函数要灵活，其实||就是用来替换concat函数的。</p>
<h3 id="27-sql和sqlplus">2.7 SQL和sqlplus</h3>
<p>我们已经学习使用了<code>select</code>，应该知道还有update、delete、insert、create…</p>
<p>同时，我们学习了ed、c、set、col、desc….</p>
<p>SQL是语言，关键字不能缩写。</p>
<p>sqlplus是oracle提供的工具，可在里面执行SQL语句，它配有自己的命令(ed、c、set、col) 特点是缩写关键字。</p>
<p>SQL</p>
<ul>
<li>
<p>一种语言</p>
</li>
<li>
<p>ANSI 标准</p>
</li>
<li>
<p>关键字不能缩写</p>
</li>
<li>
<p>使用语句控制数据库中的表的定义信息和表中的数据</p>
</li>
</ul>
<p>SQL*Plus</p>
<ul>
<li>
<p>一种环境</p>
</li>
<li>
<p>Oracle 的特性之一</p>
</li>
<li>
<p>关键字可以缩写</p>
</li>
<li>
<p>命令不能改变数据库中的数据的值</p>
</li>
<li>
<p>集中运行</p>
</li>
</ul>
<h2 id="3-过滤和排序数据">3 过滤和排序数据</h2>
<h3 id="31-where条件过滤">3.1 where条件过滤</h3>
<p>在where条件中使用的列的值对大小写是敏感的, 如是字符串需要用单引号引起来, 如KING和king是不同的字符串。</p>
<p>如<code>select * from emp where ename= 'KiNg '</code>；未选定行</p>
<p><code> select * from emp where ename= 'KING '</code>； 正确</p>
<p>说明： 对于列的值来说，大小写是敏感的。</p>
<p>​    [未选定行]不是发生了错误，而是查不到记录。</p>
<h4 id="311-日期格式"><strong>3.1.1</strong> 日期格式</h4>
<p>查询入职日期为1981年11月17日的员工</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> hiredate<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1981-11-17 &#39;</span>;
</span></span></code></pre></div><p>会报错，ORA-01861: 文字与格式字符串不匹配。</p>
<p>首先查询一下emp使用的日期格式：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>使用sysdate函数获取当前系统的日期：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> sysdate
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>查询得出格式为： <code>DD-MON-RR</code></p>
<p>应该使用当前系统指定的日期格式来查询：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> hiredate <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;17-11月-81&#39;</span>;
</span></span></code></pre></div><p>如何获取当前系统的日期格式?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> v$nls_parameters;
</span></span></code></pre></div><p>若格式不太好看，可以执行col parameter for a30设置列的宽度。</p>
<p>如何修改日期格式?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">session</span> <span style="color:#66d9ef">SET</span> NLS_DATE_FORMAT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;yyyy-mm-dd &#39;</span>;
</span></span></code></pre></div><p>查看修改结果：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> v$nls_parameters;
</span></span></code></pre></div><p>验证：再次查询emp表：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> hiredate<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1981-11-17 &#39;</span>;
</span></span></code></pre></div><p>修改日期格式到秒</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">session</span> <span style="color:#66d9ef">SET</span> NLS_DATE_FORMAT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span>;
</span></span></code></pre></div><p>执行<code>select sysdate from dual;</code>验证修改结果.</p>
<p>将日期格式改回默认设置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">session</span> <span style="color:#66d9ef">SET</span> NLS_DATE_FORMAT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;DD-MON-RR&#39;</span>;
</span></span></code></pre></div><p>说明:</p>
<ul>
<li>
<p>字符和日期要包含在单引号中。</p>
</li>
<li>
<p>字符大小写敏感, 日期格式敏感。</p>
</li>
<li>
<p>默认的日期格式是<code>DD-MON-RR</code></p>
</li>
</ul>
<h4 id="312-比较运算"><strong>3.1.2</strong> 比较运算</h4>
<p>l 普通比较运算符：</p>
<p>= 	等于(不是==)		&gt; 	大于</p>
<p>&gt;= 大于等于		  &lt; 	小于</p>
<p>&lt;= 小于等于			&lt;&gt;	不等于(也可以是!=)</p>
<p>案例:</p>
<p>1 查询薪水不等于1250的员工信息</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#f92672">&lt;&gt;</span> <span style="color:#ae81ff">1250</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1250</span>;
</span></span></code></pre></div><p>between…and:介于两值之间,闭区间,包含两边的值.</p>
<p>案例:</p>
<p>查询工资在1000-2000之间的员工：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> sal<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">2000</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">BETWEEN</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> <span style="color:#ae81ff">2000</span>; 
</span></span></code></pre></div><p>​	注意：1.包含边界  2. 小值在前，大值在后。 (对于日期也是如此)</p>
<p>2 查询81年2月至82年2月(不含2月)入职的员工信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> hiredate
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">BETWEEN</span> <span style="color:#e6db74">&#39;1-2月-81&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> <span style="color:#e6db74">&#39;30-1月-82&#39;</span>;
</span></span></code></pre></div><p>in：在集合中, not in 不在集合中</p>
<p>案例</p>
<ol>
<li>查询部门号为10和20的员工信息：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">OR</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno <span style="color:#66d9ef">IN</span> (<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>); 
</span></span></code></pre></div><ol start="2">
<li>查询部门号不是10和20的员工(除了10和20以外的部门)</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">IN</span> (<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>);
</span></span></code></pre></div><pre><code>使用比较运算符该怎么写呢？
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">!=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> deptno<span style="color:#f92672">!=</span><span style="color:#ae81ff">20</span>;
</span></span></code></pre></div><p>如果是 ….. not in (10, 20, NULL) 可不可以呢?</p>
<pre><code>☆NULL空值:如果结果中含有NULL,不能使用not in 操作符,但可以使用in操作符。

课后思考为什么???
</code></pre>
<p>因为: not in (10, 20, NULL)相当于:</p>
<p><code>deptno!=10 and deptno!=20 and deptno!=NULL</code>包含<code>NULL</code>的表达式都为空.</p>
<p>like：模糊查询</p>
<p>%匹配任意多个字符,  _匹配一个字符, 使用escape表示转义字符</p>
<p>案例:</p>
<ol>
<li>
<p>查询名字以S开头的员工</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> ename <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;S% &#39;</span>;
</span></span></code></pre></div><p>(注意：S小写、大写不同)</p>
</li>
<li>
<p>查询名字是4个字的员工</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> ename <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;_ _ _ _&#39;</span>;
</span></span></code></pre></div></li>
<li>
<p>增加测试例子：向表中插入员工：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> emp(empno, ename, sal, deptno) <span style="color:#66d9ef">values</span>(<span style="color:#ae81ff">1001</span>, <span style="color:#e6db74">&#39; TOM_ABC &#39;</span>, <span style="color:#ae81ff">3000</span>, <span style="color:#ae81ff">10</span>);
</span></span></code></pre></div></li>
<li>
<p>查询名字中包含_的员工：</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> ename <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;% _ % &#39;</span>;
</span></span></code></pre></div><p>查不到记录.</p>
<p>转义字符：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> ename <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%\_% &#39;</span> <span style="color:#66d9ef">escape</span> <span style="color:#e6db74">&#39;\&#39;</span>; 
</span></span></code></pre></div><p>转义单引号本身使用两个单引号来完成转义</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#e6db74">&#39;hello &#39;&#39; world&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><h4 id="313-逻辑运算"><strong>3.1.3</strong> 逻辑运算</h4>
<p>逻辑运算符</p>
<p>AND	 逻辑并</p>
<p>OR 		逻辑或</p>
<p>NOT	 逻辑非</p>
<p>如果…..where 表达式1 and/or 表达式2;</p>
<pre><code>…..where 表达式2 and/or 表达式1;			
</code></pre>
<p>这两句SQL语句功能一样吗？效率一样吗？</p>
<p>※SQL优化：</p>
<p>SQL在解析where的时候，是从右至左解析的。</p>
<p>所以： and时应该将易假的值放在右侧;</p>
<pre><code>  or时应该将易真的值放在右侧.
</code></pre>
<p>这样的话可以提高效率.</p>
<p>案例:</p>
<ol>
<li>查询部门为30且工种为SALESMAN的员工</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> job<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SALESMAN&#39;</span>;
</span></span></code></pre></div><ol start="2">
<li>查询部门为10或者工资大于2000的员工</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">OR</span> sal<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2000</span>;
</span></span></code></pre></div><ol start="3">
<li>查询工种不是MANAGER或者PRISIDENT的员工</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> job<span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;MANAGER&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> job<span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;PRISIDENT&#39;</span>; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> job <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">IN</span> (<span style="color:#e6db74">&#39;MANAGER&#39;</span>, <span style="color:#e6db74">&#39;PRESIDENT&#39;</span>);
</span></span></code></pre></div><h4 id="314-order-by-排序"><strong>3.1.4</strong> order by 排序</h4>
<p>使用 ORDER BY 子句排序</p>
<ul>
<li>
<p>ASC（ascend）: 升序。默认采用升序方式。</p>
</li>
<li>
<p>DESC（descend）: 降序</p>
</li>
</ul>
<p>ORDER BY子句在SELECT语句的最末尾, 是对select查询的最后的结果进行排序.</p>
<p>案例:</p>
<ol>
<li>查询emp表, 按照入职日期先后排序</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  hiredate;
</span></span></code></pre></div><ol start="2">
<li>查询员工信息, 按月薪排序</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  sal;   <span style="color:#f92672">#</span> <span style="color:#75715e">---从小到大排序, 默认方式.	
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  sal <span style="color:#66d9ef">desc</span>;  <span style="color:#f92672">#</span> <span style="color:#75715e">---从大到小排序
</span></span></span></code></pre></div><p>order by 之后可以跟那些内容呢？</p>
<p>order by + 列名, 序号, 表达式, 别名,</p>
<p>注意：语法要求order by子句应放在select的结尾。</p>
<p>案例:</p>
<ol>
<li>查询员工信息, 按月薪排序&mdash;-à使用列名排序的情况</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  sal;
</span></span></code></pre></div><ol start="2">
<li>按照工资进行排序&ndash;à使用序号进行排序的情况</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> ename,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span>,
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">desc</span>;
</span></span></code></pre></div><p>序号: 按照select后面列名出现的先后顺序, ename→1, sal→2, sal*12→3</p>
<ol start="3">
<li>按照员工的年薪进行排序&mdash;-à使用表达式排序的情况</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> ename,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  sal <span style="color:#f92672">*</span> <span style="color:#ae81ff">12</span> <span style="color:#66d9ef">desc</span>;
</span></span></code></pre></div><ol start="4">
<li>按照员工的年薪进行排序&mdash;-à使用别名进行排序的情况</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> ename,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span> <span style="color:#e6db74">&#34;年薪&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  <span style="color:#e6db74">&#34;年薪&#34;</span> <span style="color:#66d9ef">desc</span>;
</span></span></code></pre></div><p><strong>按照两列或者多列进行排序</strong></p>
<p>案例:</p>
<ol>
<li>按照部门和工资进行排序</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  deptno, sal;
</span></span></code></pre></div><p>order by后有多列时, 列名之间用逗号隔分, order by会同时作用于多列。上例的运行结果会在同一部门内升序, 部门间再升序。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  deptno, sal <span style="color:#66d9ef">desc</span>;
</span></span></code></pre></div><p>注意: desc只作用于最近的一列, 两列都要降序排, 则需要两个desc。即：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  deptno <span style="color:#66d9ef">desc</span>, sal <span style="color:#66d9ef">desc</span>;
</span></span></code></pre></div><ol start="2">
<li>查询员工信息, 按奖金由高到低排序：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  comm <span style="color:#66d9ef">desc</span>;
</span></span></code></pre></div><p>结果前面的值为NULL, 数据在后面, 如果是一个100页的报表，这样显示肯定不</p>
<p>正确。较为人性化的显示应该将空值放在最后, 即：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  comm <span style="color:#66d9ef">DESC</span> nulls <span style="color:#66d9ef">last</span>;
</span></span></code></pre></div><p>(注意：是 <code>nulls</code> 而不是null)</p>
<p><strong>排序的规则</strong></p>
<ul>
<li>
<p>可以按照select语句中的列名排序</p>
</li>
<li>
<p>可以按照别名排序</p>
</li>
<li>
<p>可以按照表达式排序,如order by sal*12+nvl(comm, 0)</p>
</li>
<li>
<p>可以按照select语句中的列名的顺序值(序号)排序</p>
</li>
<li>
<p>如果要按照多列进行排序，则规则是先按照第一列排序，如果相同，则按照第二列排序；以此类推</p>
</li>
<li>
<p>desc和asc只作用于最近的一列.</p>
</li>
</ul>
<h2 id="4-单行函数">4 单行函数</h2>
<p>单行函数:只对一行进行变换, 产生一个结果。函数可以没有参数, 但必须要有返回值。如：concat、nvl</p>
<ul>
<li>
<p>操作数据对象</p>
</li>
<li>
<p>接受参数返回一个结果</p>
</li>
<li>
<p>只对一行进行变换</p>
</li>
<li>
<p>每行返回一个结果</p>
</li>
<li>
<p>可以转换数据类型</p>
</li>
<li>
<p>可以嵌套</p>
</li>
<li>
<p>参数可以是一列或一个值</p>
</li>
</ul>
<h3 id="41-字符函数">4.1 字符函数</h3>
<p>操作对象是字符串。</p>
<p>大致可分为两大类: 一类是大小写控制函数, 主要有lower、upper、initcap:</p>
<p>案例:</p>
<p>大小写转换lower和upper, 首字母大写initcap函数测试</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">lower</span>(<span style="color:#e6db74">&#39;HeLlo, WORld&#39;</span>) <span style="color:#960050;background-color:#1e0010">转小写</span>, <span style="color:#66d9ef">upper</span>(<span style="color:#e6db74">&#39;HellO, woRld&#39;</span>) <span style="color:#960050;background-color:#1e0010">转大写</span>, initcap(<span style="color:#e6db74">&#39;hello, world&#39;</span>) <span style="color:#960050;background-color:#1e0010">首字母大写</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>另一类是字符控制函数: 有CONCAT、SUBSTR、LENGTH/LENGTHB、INSTR、LPAD | RPAD、TRIM、REPLACE</p>
<p>substr(a, b)：在字符串a中，从第b位开始取(计数从1开始)，取到结尾</p>
<p>案例:</p>
<p>从helloworld字符串中的第3位开始后面的所有字符</p>
<p><code>select substr('helloworld', 3) from dual;</code> &mdash;à得到lloworld</p>
<p>substr(a, b, c)：从a中，第b位开始，向右取c位。</p>
<p>案例:</p>
<p>从hello world字符串中, 从第3位开始取连续取5个字符</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> substr(<span style="color:#e6db74">&#39;helloworld&#39;</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>length:字符数, lengthb:字节数：</p>
<p>案例:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">length</span>(<span style="color:#e6db74">&#39;hello world&#39;</span>) <span style="color:#960050;background-color:#1e0010">字符数</span>, lengthb(<span style="color:#e6db74">&#39;hello world&#39;</span>) <span style="color:#960050;background-color:#1e0010">字节数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">length</span>(<span style="color:#e6db74">&#39;哈喽我的&#39;</span>) <span style="color:#960050;background-color:#1e0010">字符数</span>, lengthb(<span style="color:#e6db74">&#39;哈喽我的&#39;</span>) <span style="color:#960050;background-color:#1e0010">字节数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual; 
</span></span></code></pre></div><p>注意:对于length函数一个汉字是一个字符, 对于lengthb函数,一个汉字占两个,</p>
<p>这两个函数对于普通字符串没有什么区别.</p>
<p>instr: 在母串中查找子串, 找到返回下标, 计数从1开始, 没有返回0</p>
<p>案例</p>
<p>查找hello world字符串中, llo子串首次出现的下标位置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> instr(<span style="color:#e6db74">&#39;hello world&#39;</span>, <span style="color:#e6db74">&#39;llo&#39;</span>), instr(<span style="color:#e6db74">&#39;hello world&#39;</span>, <span style="color:#e6db74">&#39;www&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>注意: 下标是从1开始的.</p>
<p>lpad：左填充，</p>
<p>参1: 待填充的字符串，</p>
<p>参2: 填充后字符串的总长度(字节)，</p>
<p>参3: 填充什么</p>
<p>rpad: 右填充, 参数同lpad.</p>
<p>案例</p>
<ol>
<li><code>select lpad('abcd', 10, '*') 左, rpad('abcd', 10, '#') 右 from dual;</code></li>
</ol>
<p>结果显示: ******abcd abcd######</p>
<ol start="2">
<li><code>select lpad('abcd', 15, '你')左填充, rpad('abcd', 16, '我') 右填充 from dual;   </code></li>
</ol>
<p>结果显示:  你你你你你abcd abcd我我我我我我</p>
<p>注意: lpad(&lsquo;abcd&rsquo;, 15, &lsquo;你&rsquo;)由于abcd本身占4个字节, 需要填充11个字节才能</p>
<p>够15个字节, 但是一个汉字占两个字节, 所以填充了1个空格+5个汉字.</p>
<p>trim:去掉前后指定的字符(不去掉中间的)</p>
<p>案例</p>
<ol>
<li>
<p>去掉&rsquo;  hello world  &lsquo;两端的空格</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">trim</span>(<span style="color:#e6db74">&#39; hello world &#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div></li>
<li>
<p>去掉Hello worldH字符串前后的H字符</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">trim</span>(<span style="color:#e6db74">&#39;H&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> <span style="color:#e6db74">&#39;Hello worldH&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div></li>
</ol>
<p>replace:替换</p>
<p>案例</p>
<ol>
<li>
<p>将hello world字符串中的l替换成*</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">replace</span>(<span style="color:#e6db74">&#39;hello world&#39;</span>, <span style="color:#e6db74">&#39;l&#39;</span>, <span style="color:#e6db74">&#39;*&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div></li>
<li>
<p>删除字符串&rsquo;hello world&rsquo;中的字符&rsquo;l&rsquo;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">replace</span>(<span style="color:#e6db74">&#39;hello world&#39;</span>, <span style="color:#e6db74">&#39;l&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div></li>
</ol>
<h3 id="42-数值函数">4.2 数值函数</h3>
<p>ROUND: 四舍五入</p>
<p>ROUND(45.926, 2)	45.93</p>
<p>TRUNC:	 截断</p>
<p>TRUNC(45.926, 2)	45.92</p>
<p>MOD: 求余</p>
<p>MOD(1600, 300)	  100</p>
<ol>
<li>案例:</li>
</ol>
<p>round(45.926, 2) :2表达的含义是小数点向右保留两位并四舍五入，第二个参数如果是0可以省略.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> round(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>         round(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>         round(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">0</span>) ,
</span></span><span style="display:flex;"><span>         round(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>),
</span></span><span style="display:flex;"><span>         round(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) ,
</span></span><span style="display:flex;"><span>         round(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><ol start="2">
<li>trunc函数, 正数表示小数点之后, 负数表示小数点之前的位数, 0可以不写.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> trunc(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>         trunc(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>         trunc(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">0</span>),
</span></span><span style="display:flex;"><span>         trunc(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>),
</span></span><span style="display:flex;"><span>         trunc(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) ,
</span></span><span style="display:flex;"><span>         trunc(<span style="color:#ae81ff">45</span>.<span style="color:#ae81ff">926</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><ol start="3">
<li>mod函数: 求余数</li>
</ol>
<p><code>select mod(1600, 600) from dual;</code>  &ndash;à结果为100</p>
<ol start="4">
<li>ceil函数:向上取整</li>
</ol>
<p>floor函数:向下取整</p>
<p><code>select ceil(19.23), floor(19.23) from dual;</code></p>
<h3 id="43-时间函数">4.3 时间函数</h3>
<p>在Oracle中日期型的数据，既有日期部分，也有时间部分.</p>
<p>案例:</p>
<ol>
<li><code>select sysdate from dual;</code></li>
</ol>
<p>这里没有时间部分，因为系统默认的格式中不显示时间</p>
<ol start="2">
<li><code>select to_char(sysdate, 'yyyy-mm-dd hh24:mi:ss') from dual;</code></li>
</ol>
<p>显示日期到秒</p>
<ol start="3">
<li><code>select to_char(sysdate, 'day') from dual ;</code></li>
</ol>
<p>可以显示当前日期星期几</p>
<p>日期加、减数字得到的结果仍为日期。单位：天</p>
<p>显示 昨天、今天、明天</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> (sysdate<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#960050;background-color:#1e0010">昨天</span>,
</span></span><span style="display:flex;"><span>         (sysdate) <span style="color:#960050;background-color:#1e0010">今天</span>,
</span></span><span style="display:flex;"><span>         (sysdate <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#960050;background-color:#1e0010">明天</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> to_char(sysdate<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#e6db74">&#39;yyyy-mm-dd&#39;</span>) <span style="color:#960050;background-color:#1e0010">昨天</span>, to_char(sysdate, <span style="color:#e6db74">&#39;yyyy-mm-dd&#39;</span>) <span style="color:#960050;background-color:#1e0010">今天</span>, to_char(sysdate<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;yyyy-mm-dd&#39;</span>) <span style="color:#960050;background-color:#1e0010">明天</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual; <span style="color:#960050;background-color:#1e0010">à转换日期格式</span>;
</span></span></code></pre></div><p>既然一个日期型的数据加上或者减去一个数字得到的结果仍为日期，两个日期相减，得到的就是相差的天数。</p>
<p>计算员工的工龄, 显示从入职以来的总天数, 星期数, 总月数, 总年数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> ename,
</span></span><span style="display:flex;"><span>         hiredate,
</span></span><span style="display:flex;"><span>         (sysdate <span style="color:#f92672">-</span> hiredate) <span style="color:#960050;background-color:#1e0010">天</span>,
</span></span><span style="display:flex;"><span>         (sysdate <span style="color:#f92672">-</span> hiredate)<span style="color:#f92672">/</span><span style="color:#ae81ff">7</span> <span style="color:#960050;background-color:#1e0010">星期</span>,
</span></span><span style="display:flex;"><span>         (sysdate <span style="color:#f92672">-</span> hiredate)<span style="color:#f92672">/</span><span style="color:#ae81ff">30</span> <span style="color:#960050;background-color:#1e0010">月</span>,
</span></span><span style="display:flex;"><span>         (sysdate <span style="color:#f92672">-</span> hiredate)<span style="color:#f92672">/</span><span style="color:#ae81ff">365</span> <span style="color:#960050;background-color:#1e0010">年</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>日期和日期可以相减表示相隔多少天, 但是不允许相加, 两个日期相加没有意义, 日期只能和数字相加&mdash;-à类似于两个指针相加没有意义一样.</p>
<p>​	<code>select sysdate+hiredate from emp; </code></p>
<p>报错: ORA-00975: 不允许日期 + 日期</p>
<h3 id="44-日期函数">4.4 日期函数</h3>
<p>上面求取员工工龄的结果不精确，如果想将其算准确，可以使用日期函数来做。</p>
<p><strong>months_between</strong></p>
<p>两个日期值相差的月数(精确值)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> ename,
</span></span><span style="display:flex;"><span>         hiredate,
</span></span><span style="display:flex;"><span>         (sysdate<span style="color:#f92672">-</span>hiredate)<span style="color:#f92672">/</span><span style="color:#ae81ff">30</span> <span style="color:#960050;background-color:#1e0010">一</span>,
</span></span><span style="display:flex;"><span>         months_between(sysdate,
</span></span><span style="display:flex;"><span>         hiredate) <span style="color:#960050;background-color:#1e0010">二</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>months_between函数更精确, 在表示月份差的时候要使用months_between函数.</p>
<p><strong>add_months</strong></p>
<p>在某个日期值上，加上多少的月，正数向后计算，负数向前计算。</p>
<p>计算95个月以后是哪年、哪月、那天：</p>
<p><code>select add_months(sysdate, 95) 哪一天 from dual;</code></p>
<p>结果是: 2025/10/11</p>
<p><strong>last_day</strong></p>
<p>日期所在月的最后一天, 要么30, 31或者28</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_day(sysdate)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>上个月的最后一天</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_day(add_months(sysdate,
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>下一个月的最后一天</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> last_day(add_months(sysdate,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p><strong>next_day</strong>:指定日期的下一个日期</p>
<p>从当前时间算起, 下一个星期一的日期</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> next_day(sysdate,
</span></span><span style="display:flex;"><span>         <span style="color:#e6db74">&#39;星期一&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>从特定日期得到之后的第一个星期几的日期</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> next_day(to_date(<span style="color:#e6db74">&#39;2017-11-11&#39;</span>, <span style="color:#e6db74">&#39;yyyy-mm-dd&#39;</span>), <span style="color:#e6db74">&#39;星期三&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>round、trunc 对日期型数据进行四舍五入和截断</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> round(sysdate,
</span></span><span style="display:flex;"><span>         <span style="color:#e6db74">&#39;month&#39;</span>), round(sysdate, <span style="color:#e6db74">&#39;year&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> trunc (sysdate,
</span></span><span style="display:flex;"><span>         <span style="color:#e6db74">&#39;month&#39;</span>), trunc(sysdate, <span style="color:#e6db74">&#39;year&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><h3 id="45-转换函数">4.5 转换函数</h3>
<p>在不同的数据类型之间完成转换, 如将&quot;123&quot;转换为123, 有隐式转换和显示转换之分。</p>
<p>隐式转换(由oracle数据库来完成)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> hiredate <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;17-11月-81&#39;</span>; 
</span></span></code></pre></div><p>若是显示转换:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> to_char(hiredate, <span style="color:#e6db74">&#39;DD-MON-RR&#39;</span>) <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;17-11月-81&#39;</span>;
</span></span></code></pre></div><p>或者</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> hiredate <span style="color:#f92672">=</span> to_date(<span style="color:#e6db74">&#39;17-11月-81&#39;</span>, <span style="color:#e6db74">&#39;DD-MON-RR&#39;</span>);
</span></span></code></pre></div><p>显示转换(通过转换函数来完成)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> to_char(sysdate,
</span></span><span style="display:flex;"><span>         <span style="color:#e6db74">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>注意: 隐式转换，前提条件是：被转换的对象是可以转换的。（ABC→625 可以吗？）</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps5.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps5.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<p>显示转换：借助to_char(数据，格式)、to_number、to_date函数来完成转换。</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps6.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps6.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<p>​</p>
<table>
<thead>
<tr>
<th>格式</th>
<th>说明</th>
<th>举例</th>
</tr>
</thead>
<tbody>
<tr>
<td>YYYY</td>
<td>Full year in numbers</td>
<td>2011</td>
</tr>
<tr>
<td>YEAR</td>
<td>Year spelled out(年的英文全称)</td>
<td>twenty eleven</td>
</tr>
<tr>
<td>MM</td>
<td>Two-digit value of month 月份（两位数字）</td>
<td>04</td>
</tr>
<tr>
<td>MONTH</td>
<td>Full name of the month（月的全称）</td>
<td>4月</td>
</tr>
<tr>
<td>DY</td>
<td>Three-letter abbreviation of the day of the week(星期几)</td>
<td>星期一</td>
</tr>
<tr>
<td>DAY</td>
<td>Full name of the day of the week</td>
<td>星期一</td>
</tr>
<tr>
<td>DD</td>
<td>Numeric day of the month</td>
<td>02</td>
</tr>
</tbody>
</table>
<p>如果隐式转换和显示转换都可以使用，应该首选哪个呢？</p>
<p>注意：如果隐式、显示都可以使用，应该首选显示，这样可以省去oracle的解析过程。</p>
<p>练习：在屏幕上显示如下字符串：</p>
<p>2015-05-11 16:17:06 今天是 星期一</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> to_char(sysdate,
</span></span><span style="display:flex;"><span>         <span style="color:#e6db74">&#39;yyyy-mm-dd hh24:mi:ss &#34;今天是&#34; day&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>说明: 在固定的格式里加入自定义的格式，是可以的，必须要加””。</p>
<p>反向操作：已知字符串'2015-05-11 15:17:06 今天是 星期一&rsquo;转化成日期.</p>
<p>使用<code>to_date</code>函数将字符串转换成date类型</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> to_date(<span style="color:#e6db74">&#39;2015-05-11 15:17:06 今天是 星期一&#39;</span>, <span style="color:#e6db74">&#39;yyyy-mm-dd hh24:mi:ss &#34;今天是&#34; day&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps7.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps7.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<p>案例:</p>
<ol>
<li>查询员工的薪水: 使用2位小数, 本地货币代码, 千位符</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> to_char(sal,
</span></span><span style="display:flex;"><span>         <span style="color:#e6db74">&#39;L9,999.99&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>特别注意:&lsquo;L9,999.99&rsquo;之间没有空格</p>
<ol start="2">
<li>将￥2,975.00转化成数字：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> to_number(<span style="color:#e6db74">&#39;￥2,975.00&#39;</span>, <span style="color:#e6db74">&#39;L9,999.99&#39;</span>) <span style="color:#960050;background-color:#1e0010">转成数字</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><h3 id="46-通用函数了解">4.6 通用函数(了解)</h3>
<p>这些函数适用于任何数据类型，同时也适用于空值：</p>
<p>NVL (expr1, expr2)</p>
<p>NVL2 (expr1, expr2, expr3)</p>
<p>NULLIF (expr1, expr2)</p>
<p>COALESCE (expr1, expr2, &hellip;, expr<strong>n</strong>)</p>
<p>nvl2:是nvl函数的增强版。	nvl2(a, b, c)  当a = null 返回 c, 否则返回b</p>
<p>使用nvl2求员工的年收入：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span>,
</span></span><span style="display:flex;"><span>         sal <span style="color:#f92672">*</span> <span style="color:#ae81ff">12</span> <span style="color:#f92672">+</span> nvl2(comm,
</span></span><span style="display:flex;"><span>         comm,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">0</span>) <span style="color:#960050;background-color:#1e0010">年薪</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp; 
</span></span></code></pre></div><p>nullif: nullif(a, b) 当 a = b 时返回null, 不相等的时候返回a值。</p>
<p><code>select nullif('hello', 'hello') from dual; </code> 返回空</p>
<p><code>select nullif('hello', 'world') from dual;</code> 返回hello</p>
<p><code>select ename, nullif(comm, null) from emp;</code></p>
<p>coalesce:coalesce(a, b, c, …, n) 从左向右找参数中第一个不为空的值。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> comm,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         coalesce(comm,
</span></span><span style="display:flex;"><span>         sal) <span style="color:#960050;background-color:#1e0010">结果值</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><h3 id="47-条件表达式">4.7 条件表达式</h3>
<p>例子：老板打算给员工涨工资, 要求：</p>
<p>总裁(PRESIDENT)涨1000, 经理(MANAGER)涨800, 其他人涨400. 请将涨前, 涨后的薪水列出。</p>
<p>涨后的薪水是根据job来判断的</p>
<p>思路：	if 是总裁(&lsquo;PRESIDENT&rsquo;)  then + 1000</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#960050;background-color:#1e0010">是经理</span>(<span style="color:#e6db74">&#39;MANAGER&#39;</span>)  <span style="color:#66d9ef">then</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">800</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">400</span>									
</span></span></code></pre></div><p>但是在SQL中无法实现if else 逻辑。当有这种需求的时候，可以使用case 或者 decode</p>
<p>case:是一个表达式，其语法为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CASE</span> <span style="color:#f92672">*</span>expr
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHEN</span> <span style="color:#f92672">*</span>comparison_expr1 <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>return_expr1 [<span style="color:#66d9ef">WHEN</span> <span style="color:#f92672">*</span>comparison_expr2 <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>return_expr2
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHEN</span> <span style="color:#f92672">*</span>comparison_exprn <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>return_exprn
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">ELSE</span> <span style="color:#f92672">*</span>else_expr]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">END</span> <span style="color:#66d9ef">SQL</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">SELECT</span> ename,
</span></span><span style="display:flex;"><span>         job,
</span></span><span style="display:flex;"><span>         sal <span style="color:#960050;background-color:#1e0010">涨前薪水</span>,
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">CASE</span> job
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHEN</span> <span style="color:#e6db74">&#39;PRESIDENT&#39;</span> <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>    sal<span style="color:#f92672">+</span><span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHEN</span> <span style="color:#e6db74">&#39;MANAGER&#39;</span> <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>    sal<span style="color:#f92672">+</span><span style="color:#ae81ff">800</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">ELSE</span> sal <span style="color:#f92672">+</span> <span style="color:#ae81ff">400</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">END</span> <span style="color:#960050;background-color:#1e0010">涨后薪水</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>注意语法：when then 与下一个when then以及end之间没有“,”分割符, 可以将when当成if.</p>
<p>decode：是一个函数，其语法为：</p>
<p>DECODE(*col|expression, search1, result1</p>
<pre><code>[*, search2, result2,...,]
   
[*, default])
</code></pre>
<p>除第一个和最后一个参数之外，中间的参数都是成对呈现的 (参1, 条件, 值, 条件, 值, …, 条件, 值, 尾参)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> ename,
</span></span><span style="display:flex;"><span>         job,
</span></span><span style="display:flex;"><span>         sal <span style="color:#960050;background-color:#1e0010">涨前薪水</span>,
</span></span><span style="display:flex;"><span>         decode(job,
</span></span><span style="display:flex;"><span>         <span style="color:#e6db74">&#39;PRESIDENT&#39;</span>, sal <span style="color:#f92672">+</span> <span style="color:#ae81ff">1000</span>, <span style="color:#e6db74">&#39;MANAGER&#39;</span>, sal <span style="color:#f92672">+</span> <span style="color:#ae81ff">800</span>, sal <span style="color:#f92672">+</span> <span style="color:#ae81ff">400</span>) <span style="color:#66d9ef">AS</span> <span style="color:#960050;background-color:#1e0010">涨后薪水</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><h2 id="5-分组函数">5 分组函数</h2>
<h3 id="51分组函数">5.1分组函数</h3>
<p>多行函数也叫组函数，本章学习目标:</p>
<ul>
<li>
<p>了解组函数。</p>
</li>
<li>
<p>描述组函数的用途。</p>
</li>
<li>
<p>使用GROUP BY 子句数据分组。</p>
</li>
<li>
<p>使用HAVING 子句过滤分组结果集。</p>
</li>
</ul>
<p>分组函数作用于一组数据，并对一组数据返回一个值</p>
<p>常用的有5个函数: avg、count、max、min、sum操作的是一组数据，返回一个结果。</p>
<p>案例</p>
<ol>
<li>求员工的工资总额</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">sum</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp; 
</span></span></code></pre></div><ol start="2">
<li>求员工人数</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><ol start="3">
<li>平均工资</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">sum</span>(sal)<span style="color:#f92672">/</span><span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>) <span style="color:#960050;background-color:#1e0010">方式一</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">avg</span>(sal) <span style="color:#960050;background-color:#1e0010">方式二</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>方式一和方式二结果一样, 当有空值得时候结果有可能不一样。如：奖金。</p>
<ol start="4">
<li>求员工的平均奖金</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">sum</span>(comm)<span style="color:#f92672">/</span><span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>) <span style="color:#960050;background-color:#1e0010">方式一</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">sum</span>(comm)<span style="color:#f92672">/</span><span style="color:#66d9ef">count</span>(comm) <span style="color:#960050;background-color:#1e0010">方式二</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">avg</span>(comm) <span style="color:#960050;background-color:#1e0010">方式三</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>结果：方式一结果不同，方式二 和 方式三结果一样。</p>
<p>说明: avg(comm)是求comm有值的几个的平均值, 跟方式二是相同的.</p>
<p>NULL空值：组函数都有自动滤空功能(忽略空值)，所以：</p>
<p><code>select count(*), count(comm) from emp;</code> 执行结果不相同。</p>
<p>说明: count(comm)返回不为空的comm的总个数</p>
<p>如何屏蔽组函数的滤空功能?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>),
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">count</span>(nvl(comm,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>但是实际应用中, 结果为14和结果为4都有可能对，看问题本身是否要求统计空值。</p>
<p>5 count函数</p>
<p>求emp表的部门总个数, 如果要求不重复的个数, 使用distinct。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">count</span>(<span style="color:#66d9ef">distinct</span> deptno)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp; 
</span></span></code></pre></div><p>求emp表中的工种的总个数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">count</span>(<span style="color:#66d9ef">distinct</span> job)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><h3 id="52-分组数据">5.2 分组数据</h3>
<p>分组数据使用<strong>group by</strong>关键字.</p>
<p>按照<code>group by</code> 后给定的表达式，将from后面的table进行分组。针对每一组，使用组函数, 即先分组, 再分组统计.</p>
<p>案例</p>
<ol>
<li>查询“部门”的平均工资：</li>
</ol>
<p>分析: 结合<code>select * from emp order by deptno; </code> 结果分析分组</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">avg</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno;
</span></span></code></pre></div><pre><code>上SQL语句可以抽象成：select a, 组函数(x) from 表 group by a;  这样的格式。
</code></pre>
<p>如果select a, b, 组函数(x) …… group by 应该怎么写？</p>
<p>注意: 在select列表中所有没有包含在组函数中的列, 都必须在group by的后面出现.所以上面的问题应该写成group by a, b; 没有b就会出错, 不会执行sql语句。但, 反之可以。group by a，b，c;  c可以不出现在select语句中。</p>
<p>group by后面有多列的情况：</p>
<ol start="2">
<li>查询部门内部不同职位的平均工资:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>         job,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">avg</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno, job
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  <span style="color:#ae81ff">1</span>; 
</span></span></code></pre></div><p>分析该SQL的作用：</p>
<pre><code>因为`deptno, job` 两列没有在组函数里面，所以必须同时在group by后面。
</code></pre>
<p>该SQL的语义:按部门, 不同的职位统计平均工资。先按第一列分组, 如果第一列相同, 再按第二列分组, 所以查询结果中，同一部门中没有重复的职位。</p>
<p>关于分组函数常见的问题:</p>
<ol>
<li>在select后面出现的列, 该列没有出现在分组函数中, 但是未出现在<code>group by</code>子句中.</li>
</ol>
<p>如: <code>select deptno, job, avg(sal) from emp group by deptno;</code></p>
<p>&mdash;-job未出现在group by子句中</p>
<p>报错: ORA-00979: 不是 GROUP BY 表达式.</p>
<ol start="2">
<li><code>select count(*) from emp;</code></li>
</ol>
<p>分析: count是分组函数, 但是select后面没有其他列, 所以不必非出现group by子句,</p>
<p>该sql语句意思是统计emp表中员工总数;</p>
<p>当然: `select count(*) from emp group by deptno; 也对, 但是查询出来的结果并不知道是</p>
<p>哪个组的总数.</p>
<h3 id="53-having">5.3 Having</h3>
<p>使用 HAVING 过滤分组:</p>
<ol>
<li>
<p>行已经被分组。</p>
</li>
<li>
<p>使用了组函数。</p>
</li>
<li>
<p>满足HAVING 子句中条件的分组将被显示。</p>
</li>
</ol>
<p>其语法：</p>
<p><strong>SELECT	column, group_function</strong></p>
<p><strong>FROM		table</strong></p>
<p><strong>[WHERE	condition]</strong></p>
<p><strong>[GROUP BY	group_by_expression]</strong></p>
<p><strong>[HAVING	group_condition]</strong></p>
<p><strong>[ORDER BY	column]</strong>;</p>
<p>查询平均薪水大于2000的部门 ：</p>
<p>分析：该问题实际上是在分组的基础上过滤分组。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">avg</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#66d9ef">avg</span>(sal)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2000</span>;
</span></span></code></pre></div><p>注意：<code>having</code>后面不能使用别名, 可以使用函数</p>
<p>​</p>
<p>特别注意: 不能在 <code>WHERE</code> 子句中使用组函数.</p>
<p>可以在 HAVING 子句中使用组函数。</p>
<pre><code>从功能上讲，where和having都是将满足条件的结果进行过滤。但是差别是where子句中不能使用组函数, 所以上句中的having不可以使用where代替。
</code></pre>
<p>求10号部门的平均工资：</p>
<p>分析：在上一条的基础上，<code>having deptno=10;</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">avg</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>;
</span></span></code></pre></div><p>使用where也可以做这件事</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">avg</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno;
</span></span></code></pre></div><p>在子句中没有使用组函数的情况下，where、having都可以，应该怎么选择？</p>
<p>SQL优化： 尽量采用where。</p>
<p>如果有分组的话，where是先过滤再分组，而having是先分组再过滤。当数据量庞大如1亿条，where优势明显。</p>
<h2 id="6-多表查询">6 多表查询</h2>
<p>理论基础：——笛卡尔集</p>
<ul>
<li>
<p>笛卡尔集的行数 = table1的行数 x table2的行数</p>
</li>
<li>
<p>笛卡尔集的列数 = table1的列数 + table2的列数</p>
</li>
</ul>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps8.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps8.jpg"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>在操作笛卡尔集的时候，应该避免使用“笛卡尔全集”，因为里面含有大量错误信息。</p>
<p>多表查询就是按照给定条件(连接条件)，从笛卡尔全集中选出正确的结果。</p>
<p>根据连接条件的不同可以划分为：等值链接、不等值链接、外链接、自连接</p>
<p>Oracle 连接:</p>
<p>Equijoin：等值连接</p>
<p>Non-equijoin：不等值连接</p>
<p>Outer join：外连接</p>
<p>Self join：自连接</p>
<p>SQL: 1999</p>
<p>Cross joins</p>
<p>Natural joins</p>
<p>Using clause</p>
<p>Full or two sided outer joins</p>
<h3 id="61-等值连接">6.1 等值连接：</h3>
<p>​	从概念上，区分等值连接和不等值连接非常简单，只需要辨别where子句后面的条件，是“=”为等值连接。不是“=”为不等值连接。</p>
<p>查询员工信息：员工号 姓名 月薪和部门名称</p>
<p>​	分析：这个问题涉及emp(员工号，姓名，月薪) 和dept(部门名称)两张表  ——即为多表查询。</p>
<p>​	通常在进行多表查询的时，会给表起一个别名，使用“别名.列名”的方式来获取数据，直接使用“表名.列名”语法上是允许的，但是实际很少这样用。</p>
<p>如果：<code>select e.empno, e.ename, e.sal, e.deptno, d.dname, d.deptno  from emp e, dept d; </code></p>
<p>直接得到的是笛卡尔全集。其中有错误结果。所以应该加 where 条件进行过滤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.empno,
</span></span><span style="display:flex;"><span>         e.ename,
</span></span><span style="display:flex;"><span>         e.sal,
</span></span><span style="display:flex;"><span>         d.dname
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, dept d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.deptno<span style="color:#f92672">=</span>d.deptno;
</span></span></code></pre></div><p>如果有N个表，where后面的条件至少应该有N-1个, 才会不产生笛卡尔积.</p>
<h3 id="62-不等值连接">6.2 不等值连接：</h3>
<p>将上面的问题稍微调整下，查询员工信息：员工号 姓名 月薪 和 薪水级别(salgrade表)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> salgrade;
</span></span></code></pre></div><p>看到员工总的薪水级别，共有5级，员工的薪水级别应该满足 &gt;=当前级别的下限，&lt;=该级别的上限：</p>
<p>过滤子句应该：	<code>where e.sal &gt;= s.losal and e.sal &lt;= s.hisal;</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.empno,
</span></span><span style="display:flex;"><span>         e.ename,
</span></span><span style="display:flex;"><span>         e.sal,
</span></span><span style="display:flex;"><span>         s.grade
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, salgrade s
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.sal <span style="color:#f92672">&gt;=</span> s.losal
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> e.sal <span style="color:#f92672">&lt;=</span> s.hisal;
</span></span></code></pre></div><p>更好的写法应该使用between…and:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> s.grade,
</span></span><span style="display:flex;"><span>         e.empno,
</span></span><span style="display:flex;"><span>         e.ename,
</span></span><span style="display:flex;"><span>         e.sal,
</span></span><span style="display:flex;"><span>         e.job
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, salgrade s
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.sal
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">BETWEEN</span> s.losal
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> s.hisal
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  <span style="color:#ae81ff">1</span>;
</span></span></code></pre></div><h3 id="63-外链接">6.3 外链接：</h3>
<p><strong>l</strong> 按部门统计员工人数，显示： 部门号 部门名称 人数</p>
<p>分析:</p>
<p>​	人数：一定是在emp表中，使用count()函数统计emp表中任一非空列均可。</p>
<p>​		部门名称：在dept表dname中, 直接读取即可。</p>
<p>​		部门号：任意，两张表都有, 两个表的联系是deptno.</p>
<p>所以:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> d.deptno <span style="color:#960050;background-color:#1e0010">部门号</span>,
</span></span><span style="display:flex;"><span>         d.dname <span style="color:#960050;background-color:#1e0010">部门名称</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">count</span>(e.empno) <span style="color:#960050;background-color:#1e0010">人数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, dept d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.deptno<span style="color:#f92672">=</span>d.deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  d.deptno, d.dname;
</span></span></code></pre></div><p>注意：由于使用了组函数count()，所以组函数外的<code>d.deptno</code>和<code>d.dname</code>必须放到group by后。</p>
<p>得到查询结果，但是<code>select * from dept</code>发现40号部门没有显示出来，原因是40号部门没有员工，where没满足。结果不对，40号部门没有员工，应该在40号部门位置显示0。</p>
<p>我们希望： 在最后的结果中，包含某些对于where条件来说不成立的记录 （外链接的作用）</p>
<p>l 左外链接：当 <code>where e.deptno=d.deptno</code> 不成立的时候，=左边所表示的信息，仍然被包含。</p>
<p>​	写法：与叫法相反：<code>where e.deptno=d.deptno(+)</code></p>
<p>l 右外链接：当 <code>where e.deptno=d.deptno</code> 不成立的时候，=右边所表示的信息，仍然被包含。</p>
<p>​	写法：依然与叫法相反：<code>where e.deptno(+)=d.deptno</code></p>
<p>以上我们希望将没有员工的部门仍然包含到查询的结果当中。因此应该使用外链接的语法。</p>
<p>写法1:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> d.deptno <span style="color:#960050;background-color:#1e0010">部门号</span>,
</span></span><span style="display:flex;"><span>         d.dname <span style="color:#960050;background-color:#1e0010">部门名称</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">count</span>(e.empno) <span style="color:#960050;background-color:#1e0010">人数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, dept d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.deptno(<span style="color:#f92672">+</span>)<span style="color:#f92672">=</span>d.deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  d.deptno, d.dname;
</span></span></code></pre></div><p>写法2:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> d.deptno <span style="color:#960050;background-color:#1e0010">部门号</span>,
</span></span><span style="display:flex;"><span>         d.dname <span style="color:#960050;background-color:#1e0010">部门名称</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">count</span>(e.empno) <span style="color:#960050;background-color:#1e0010">人数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, dept d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> d.deptno <span style="color:#f92672">=</span> e.deptno(<span style="color:#f92672">+</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  d.deptno, d.dname;
</span></span></code></pre></div><p>这样就可以将40号部门包含到整个查询结果中。人数是0</p>
<p>注意：不能使用count(e.*), 应该是某个表的具体的列.</p>
<p>思考: 能否使用count(<em>), count(</em>)与count(e.empno)有什么不同???</p>
<h3 id="64-自连接">6.4 自连接：</h3>
<p>核心，通过表的别名，将同一张表视为多张表。</p>
<p>例如: 查询员工信息：xxx的老板是 yyy</p>
<p>分析：执行<code>select * from emp;</code> 发现，员工的老板也在员工表之中，是一张表。要完成多表查询我们可以假设，有两张表，一张表e(emp)只存员工、另一张表b(boss)只存员工的老板。—— from e, b;</p>
<p>老板和员工之间的关系应该是：<code>where e.mgr=b.empno</code> (即:员工表的老板 = 老板表的员工)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.ename <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39; 的老板是 &#39;</span> <span style="color:#f92672">||</span> b.ename
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, emp b
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.mgr<span style="color:#f92672">=</span>b.empno;
</span></span></code></pre></div><p>执行, 发现结果正确了, 但是KING没有显示出来. KING的老板是他自己. 应该怎么显示呢?</p>
<p>使用外连接:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.ename <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39; 的老板是 &#39;</span> <span style="color:#f92672">||</span> nvl(b.ename, <span style="color:#e6db74">&#39;他自己&#39;</span> )
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, emp b
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.mgr<span style="color:#f92672">=</span>b.empno(<span style="color:#f92672">+</span>);
</span></span></code></pre></div><p>使用concat函数应该怎么做呢??</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> concat(e.ename,
</span></span><span style="display:flex;"><span>         concat(<span style="color:#e6db74">&#39; 的老板是 &#39;</span>, nvl(b.ename, <span style="color:#e6db74">&#39;他自己&#39;</span> )))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, emp b
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.mgr <span style="color:#f92672">=</span> b.empno(<span style="color:#f92672">+</span>);
</span></span></code></pre></div><h2 id="7-子查询">7 子查询</h2>
<p>子查询语法很简单，就是select 语句的嵌套使用, 即sql嵌套sql。</p>
<p>查询工资比SCOTT高的员工信息.</p>
<pre><code>分析：两步即可完成
</code></pre>
<ol>
<li>查出SCOTT的工资</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> ename,
</span></span><span style="display:flex;"><span>         sal
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> ename<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SCOTT&#39;</span>; <span style="color:#f92672">#</span> <span style="color:#960050;background-color:#1e0010">结果为</span><span style="color:#ae81ff">3000</span>
</span></span></code></pre></div><ol start="2">
<li>查询比3000高的员工</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3000</span>;
</span></span></code></pre></div><p>通过两步可以将问题结果得到。子查询，可以将两步合成一步。</p>
<p>——子查询解决的问题：问题本身不能一步求解的情况。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#f92672">&gt;</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> sal
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> ename<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SCOTT&#39;</span>); 
</span></span></code></pre></div><p>子查询语法格式：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>select_list
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">table</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#f92672">*</span>expr <span style="color:#66d9ef">operator</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>select_list
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">table</span>);
</span></span></code></pre></div><p>本章学习目标:</p>
<p>描述子查询可以解决的问题</p>
<p>定义子查询(子查询的语法)</p>
<p>列出子查询的类型。</p>
<p>书写单行子查询和多行子查询。</p>
<h3 id="71-定义子查询-需要注意的问题">7.1 定义子查询 需要注意的问题</h3>
<ol>
<li>合理的书写风格 (如上例，当写一个较复杂的子查询的时候，要合理的添加换行、缩</li>
</ol>
<p>进)</p>
<ol start="2">
<li>
<p>小括号( )</p>
</li>
<li>
<p>主查询和子查询可以是不同表，只要子查询返回的结果主查询可以使用即可</p>
</li>
<li>
<p>可以在主查询的<code>where</code>、<code>select</code>、<code>having</code>、<code>from</code>后都可以放置子查询</p>
</li>
<li>
<p>不可以在主查询的<code>group by</code>后面放置子查询 (SQL语句的语法规范)</p>
</li>
<li>
<p>强调：在from后面放置的子查询(***), from后面放置是一个集合(表、查询结果)</p>
</li>
<li>
<p>一般先执行子查询(内查询)，再执行主查询(外查询)；但是相关子查询除外</p>
</li>
<li>
<p>一般不在子查询中使用<code>order by</code>, 但在Top-N分析问题中，必须使用order by</p>
</li>
<li>
<p>单行子查询只能使用单行操作符；多行子查询只能使用多行操作符</p>
</li>
<li>
<p>子查询中的null值</p>
</li>
</ol>
<h3 id="72-主子查询在不同表间进行">7.2 主、子查询在不同表间进行。</h3>
<p>查询部门名称是“SALES”的员工信息</p>
<p>主查询：查询员工信息。<code>select * from emp;</code></p>
<p>子查询：负责根据部门名称(在dept表中)得到部门号。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dept
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> dname<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SALES&#39;</span>;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> deptno
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> dept
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> dname<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SALES&#39;</span>);
</span></span></code></pre></div><pre><code>主查询, 查询的是员工表emp, 子查询, 查询的是部门表dept。是两张不同的表。
</code></pre>
<p>将该问题使用“多表查询”解决</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, dept d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.deptno<span style="color:#f92672">=</span>d.deptno
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> d.dname<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SALES&#39;</span>; 
</span></span></code></pre></div><p>两种方式哪种好呢？</p>
<p>SQL优化: 理论上，既可以使用子查询，也可以使用多表查询，尽量使用“多表查询”。子查询有2次from, 与数据库服务的交互多.</p>
<p>不同数据库处理数据的方式不尽相同，如Oracle数据库中，子查询地位比较重要，做了深入的优化。有可能实际看到结果是子查询快于多表查询。</p>
<h3 id="73-在主查询的where-select-having-from-放置子查询">7.3 在主查询的where select having from 放置子查询</h3>
<p>子查询可以放在select后，但，要求该子查询必须是单行子查询：(该子查询本身只返回一条记录，2+叫多行子查询)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> dname
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> dept) <span style="color:#960050;background-color:#1e0010">部门</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp; 
</span></span></code></pre></div><p>注意：SQL中没有where是不可以的，那样是多行子查询。&ndash;但这是不符合实际情况的.</p>
<p>应该:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> dname
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> dept
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> deptno <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>) <span style="color:#960050;background-color:#1e0010">部门</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;
</span></span></code></pre></div><p>进一步理解查询语句，实际上是在表或集合中通过列名来得到行数据，子查询如果是多行，select无法做到这一点。</p>
<p>在 having 后 和 where 类似。但需注意在where后面不能使用组函数。</p>
<p>在having后面使用子查询的例子:</p>
<p>查询部门平均工资高于30号部门平均工资的部门和平均工资</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">avg</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">HAVING</span> <span style="color:#66d9ef">avg</span>(sal) <span style="color:#f92672">&gt;</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">avg</span>(sal)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> deptno <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>); 
</span></span></code></pre></div><h3 id="74-在from后面放置的子查询">7.4 在from后面放置的子查询(***)</h3>
<p>表, 代表一个数据集合、查询结果(SQL)语句本身也代表一个集合, 把查询结果看成一个表.</p>
<p>查询员工的姓名、薪水和年薪：</p>
<pre><code>说明：该问题不用子查询也可以完成。但如果是一道填空题：
</code></pre>
<p>select * from ___________________</p>
<p>因为显示的告诉了，要使用select *, 所以只能:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> ename,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span> <span style="color:#960050;background-color:#1e0010">年薪</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp); 
</span></span></code></pre></div><p>将select 语句放置到from后面，表示将select语句的结果，当成表来看待. 这种查询方式在Oracle语句中使用比较频繁.</p>
<h3 id="75-单行子查询只能使用单行操作符多行子查询只能使用多行操作符">7.5 单行子查询只能使用单行操作符；多行子查询只能使用多行操作符</h3>
<h4 id="751单行子查询">7.5.1单行子查询：</h4>
<p>单行子查询就是该条子查询执行结束时, 只返回一条记录(一行数据)。</p>
<p>使用单行操作符:</p>
<p>=、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;或者!=</p>
<p>单行子查询:</p>
<ol>
<li>
<p>单行子查询, 只能使用单行操作符</p>
</li>
<li>
<p>在一个主查询中可以有多个子查询。</p>
</li>
<li>
<p>子查询里面可以嵌套多层子查询。</p>
</li>
<li>
<p>子查询也可以使用组函数。子查询也是查询语句，适用于前面所有知识。</p>
</li>
</ol>
<p>案例:</p>
<ol>
<li>查询emp表部门编号为10且高于本部门的平均工资的员工信息</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">avg</span>(sal)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>;
</span></span></code></pre></div><ol start="2">
<li>查询emp表中与SMITH职位相同的员工信息</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> job <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> job
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> ename<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SMITH&#39;</span>);
</span></span></code></pre></div><ol start="3">
<li>查询薪水低于本公司的平均薪水且职位与SMITH职位相同的所有员工信息</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal<span style="color:#f92672">&lt;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">avg</span>(sal)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> job<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> job
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> ename<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SMITH&#39;</span>);
</span></span></code></pre></div><ol start="4">
<li>查询emp表中最低工资员工和最高工资员工的信息</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">max</span>(sal)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">OR</span> sal<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">min</span>(sal)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp);
</span></span></code></pre></div><p>5 思考??,下列sql语句正确吗?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">min</span>(sal)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno);
</span></span></code></pre></div><p>注意: =、&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;或者!=是单行操作符, 而后面的子查询会返回多条记录,所以会报错, 要解决这个问题要使用多行子查询.</p>
<h4 id="752多行子查询">7.5.2多行子查询：</h4>
<p>子查询返回2条记录以上就叫多行。</p>
<p>多行操作符有：</p>
<p>IN		等于列表中的任意一个</p>
<p>ANY	和子查询返回的任意一个值比较</p>
<p>ALL		和子查询返回的所有值比较</p>
<p>IN(表示在集合中)：</p>
<p>解决上面的那个问题?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#66d9ef">IN</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">min</span>(sal)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno);
</span></span></code></pre></div><p>查询部门名称为SALES和ACCOUNTING的员工信息。</p>
<p>分析：部门名称在dept表中，员工信息在emp表中,子查询应先去dept表中将SALES和ACCOUNTING的部门号得到，交给主查询得员工信息.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno <span style="color:#66d9ef">IN</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> deptno
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> dept
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> dname <span style="color:#66d9ef">IN</span> (<span style="color:#e6db74">&#39;SALES&#39;</span>, <span style="color:#e6db74">&#39;ACCOUNTING&#39;</span>));
</span></span></code></pre></div><pre><code>也可以使用多表查询来解决该问题：
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> e.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, dept d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.deptno <span style="color:#f92672">=</span> d.deptno
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> (d.dname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;SALES&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">OR</span> d.dname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ACCOUNTING&#39;</span>);
</span></span></code></pre></div><p>红色语句也可以用 <code>d.dname in ('SALES ', 'ACCOUNTING ')</code></p>
<pre><code>这种解决方式，注意使用()来控制优先级。 
</code></pre>
<p>如果查询不是这两个部门的员工，只要把in → not in就可以了，注意不能含有空值。</p>
<p>ANY(表示和集合中的任意一个值比较)：</p>
<p>查询薪水比30号部门任意一个员工高的员工信息：</p>
<p>分析：首先查出30号部门的员工薪水的集合，然后&gt;它就得到了该员工信息。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#f92672">&gt;</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> sal
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>); <span style="color:#f92672">#</span> <span style="color:#960050;background-color:#1e0010">正确吗？</span>
</span></span></code></pre></div><p>这样是错的，子句返回多行结果。而‘&gt;’是单行操作符。——应该将‘&gt;’替换成‘&gt; any’</p>
<p>实际上&gt;集合的任意一个值，就是大于集合的最小值。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">any</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> sal
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>);
</span></span></code></pre></div><p>若将这条语句改写成单行子查询应该怎么写呢？</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#f92672">&gt;</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">min</span>(sal)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>); 
</span></span></code></pre></div><p>ALL(表示和集合中的所有值比较)：</p>
<p>查询薪水比30号部门所有员工高的员工信息。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">ALL</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> sal
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>); 
</span></span></code></pre></div><p>同样，将该题改写成单行子句查询：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> sal <span style="color:#f92672">&gt;</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">max</span>(sal)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>); 
</span></span></code></pre></div><p>对于any 和 all 来说，究竟取最大值还是取最小值，不一定。将上面的两个例子中的“高”换成“低”，any和all就各自取相反的值了。</p>
<h3 id="子查询中null">子查询中null</h3>
<p>判断一个值等于、不等于空，不能使用=和!=号，而应该使用is 和 not。</p>
<p>如果集合中有NULL值，不能使用not in。如： not in (10， 20， NULL)，但是可以使用in。为什么呢？</p>
<p>先看一个例子：</p>
<p>查询不是老板的员工信息：</p>
<p>分析：不是老板就是树上的叶子节点。在emp表中有列mgr，该列表示该员工的老板的员工号是多少。那么，如果一个员工的员工号在这列中，那么说明这员工是老板，如果不在，说明他不是老板。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> empno <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">IN</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> mgr
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp);
</span></span></code></pre></div><p>但是运行没有结果，因为有NULL</p>
<p>查询是老板的员工信息：只需要将not去掉。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> empno <span style="color:#66d9ef">IN</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> mgr
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp );
</span></span></code></pre></div><p>还是我们之前null的结论：in (10, 20, null) 可以，not in (10, 20, null) 不可以</p>
<p><code>select * from emp where deptno in (10, 20, null);</code>&mdash;&ndash;可以</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">IN</span> (<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#66d9ef">null</span>);<span style="color:#f92672">#</span> <span style="color:#75715e">-----不可以
</span></span></span></code></pre></div><p>例如：a not in(10, 20, NULL) 等价于 (a != 10) and (a != 20) and (a != NULL)</p>
<p>因为, not in操作符等价于 !=All，最后一个表达式为假，整体假;</p>
<p>而a in (10, 20, NULL)等价于(a = 10) or (a = 20) or (a = null)只要有一个为真即为真。</p>
<pre><code>	 in 操作符等价于 = Any 
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno <span style="color:#f92672">=</span> <span style="color:#66d9ef">any</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#66d9ef">null</span>);	
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">#</span> <span style="color:#960050;background-color:#1e0010">等价于</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno <span style="color:#66d9ef">IN</span> (<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#66d9ef">null</span>);
</span></span></code></pre></div><p>继续，查询不是老板的员工信息, 只要将空值去掉即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> empno <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">IN</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> mgr
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> mgr <span style="color:#66d9ef">is</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">null</span>); 
</span></span></code></pre></div><p>注意: not in 后面的结合中不能有null</p>
<h3 id="一般不在子查询中使用order-by">一般不在子查询中使用order by</h3>
<p>一般情况下，子查询使用<code>order by</code>或是不使用<code>order by</code>对主查询来说没有什么意义。子查询的结果给主查询当成集合来使用，所以没有必要将子查询<code>order by</code>。</p>
<p>但，在Top-N分析问题中，必须使用<code>order by</code></p>
<h3 id="一般先执行子查询再执行主查询">一般先执行子查询，再执行主查询</h3>
<p>含有子查询的SQL语句执行的顺序是，先子后主。</p>
<p>但，相关子查询例外.</p>
<h2 id="8-集合运算">8 集合运算</h2>
<p>l 查询部门号是10和20的员工信息?	有三种方法</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno <span style="color:#66d9ef">in</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">OR</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>;
</span></span></code></pre></div><p>n 集合运算：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>;	
</span></span><span style="display:flex;"><span><span style="color:#f92672">#</span> <span style="color:#960050;background-color:#1e0010">加上</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>; 
</span></span></code></pre></div><p>集合运算所操作的对象是两个或者多个集合，而不再是表中的列(select一直在操作表中的列)</p>
<h3 id="81-集合运算符">8.1 集合运算符</h3>
<p>集合运算的操作符。A∩B、A∪ B、A - B</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps9.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps9.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">UNION</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>;
</span></span></code></pre></div><p>union和union all的区别: union会去掉重复的, 而union all会全部显示</p>
<p>注意：这是一条SQL语句。</p>
<h3 id="82-集合运算需要注意的问题">8.2 集合运算需要注意的问题：</h3>
<p>参与运算的各个集合必须列数相同，且对应每个列的类型一致。</p>
<p>采用第一个集合的表头作为最终使用的表头.</p>
<p>可以使用括号()先执行后面的语句。</p>
<p>问题：按照部门统计各部门不同工种的工资情况，要求按如下格式输出：</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps10.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps10.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<p>分析SQL执行结果。</p>
<p>第一部分数据是按照<code>deptno</code>和job进行分组；select 查询deptno、job、sum(sal)</p>
<p>第二部分数据是直接按照deptno分组即可，与job无关；select 只需要查询deptno，sum(sal)</p>
<p>第三部分数据不按照任何条件分组，即<code>group by null</code>；select 查询sum(sal)</p>
<p>所以，整体查询结果应该= <code>group by deptno,job + group by deptno + group by null</code></p>
<p>按照集合的要求,必须列数相同,类型一致,所以写法如下,使用null强行占位!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>        job,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">sum</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno,job
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">UNION</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>        to_char(<span style="color:#66d9ef">null</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">sum</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">UNION</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> to_number(<span style="color:#66d9ef">null</span>),
</span></span><span style="display:flex;"><span>        to_char(<span style="color:#66d9ef">null</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">sum</span>(sal)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>交集和差集与并集类似，也要注意以上三点。只不过算法不同而已。</p>
<p>需要注意:集合运算的性能一般较差.</p>
<p>SQL的执行时间：</p>
<pre><code>`set timing on/off`		默认是off 
</code></pre>
<h1 id="9-数据处理">9 数据处理</h1>
<h3 id="sql语言的类型">SQL语言的类型：</h3>
<ol>
<li>数据库中，称呼增删改查，为DML语句。(Data Manipulation Language 数据操纵</li>
</ol>
<p>语言)，就是指代：insert、update、delete、select这四个操作。</p>
<ol start="2">
<li>DDL语句。(Data Definition Language 数据定义语言)。</li>
</ol>
<p>如：truncate table(截断/清空 一张表)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span>(<span style="color:#960050;background-color:#1e0010">表</span>)<span style="color:#960050;background-color:#1e0010">、</span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">view</span>(<span style="color:#960050;background-color:#1e0010">视图</span>)<span style="color:#960050;background-color:#1e0010">、</span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">index</span>(<span style="color:#960050;background-color:#1e0010">索引</span>)<span style="color:#960050;background-color:#1e0010">、</span><span style="color:#66d9ef">create</span> sequence(<span style="color:#960050;background-color:#1e0010">序列</span>)<span style="color:#960050;background-color:#1e0010">、</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">create</span> synonym(<span style="color:#960050;background-color:#1e0010">同义词</span>)<span style="color:#960050;background-color:#1e0010">、</span><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span><span style="color:#960050;background-color:#1e0010">、</span><span style="color:#66d9ef">drop</span> <span style="color:#66d9ef">table</span><span style="color:#960050;background-color:#1e0010">。</span>
</span></span></code></pre></div><ol start="3">
<li>
<p>DCL语句。DCL（Data Control Language数据控制语言）如：</p>
<p>commit(提交)、rollback(回滚)</p>
</li>
</ol>
<h3 id="插入数据insert">插入数据insert：</h3>
<p>l 使用 INSERT 语句向表中插入数据。其语法为：</p>
<p>INSERT INTO	*table [(<em>column [</em>, column&hellip;])]</p>
<p>VALUES			<em>(value [</em>, value&hellip;]);</p>
<p>l 如果：values后面的值，涵盖了表中的所有列，那么table的列名可以省略不写。</p>
<p>desc emp;  	查看员工表的结构，得到所有的列名。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> emp <span style="color:#66d9ef">values</span> (<span style="color:#ae81ff">1001</span>, <span style="color:#e6db74">&#39;Tom&#39;</span>, <span style="color:#e6db74">&#39;Engineer&#39;</span>, <span style="color:#ae81ff">7839</span>, sysdate, <span style="color:#ae81ff">5000</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">10</span> );   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> emp <span style="color:#66d9ef">values</span> (<span style="color:#ae81ff">1005</span>, <span style="color:#e6db74">&#39;Bone&#39;</span>, <span style="color:#e6db74">&#39;Raphealy&#39;</span>, <span style="color:#ae81ff">7829</span>, to_date(<span style="color:#e6db74">&#39;17-12月-82&#39;</span>, <span style="color:#e6db74">&#39;DD-MON-RR&#39;</span>), <span style="color:#66d9ef">NULL</span>, <span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">20</span>); 
</span></span></code></pre></div><p>l 如果:插入的时候没有插入所有的列, 就必须显式的写出这些列的名字。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> emp(empno, ename, sal, deptno) <span style="color:#66d9ef">values</span>(<span style="color:#ae81ff">1002</span>, <span style="color:#e6db74">&#39;Marry&#39;</span>, <span style="color:#ae81ff">6000</span>, <span style="color:#ae81ff">20</span>);  
</span></span></code></pre></div><p>注意：字符串和日期都应该使用 &rsquo; &lsquo;号引用起来.</p>
<p>l 没有写出的列自动填NULL, 这种方式称之为“隐式插入空值”。</p>
<p>l 显示插入空值: insert into emp(empno, ename, sal) values(1003, &lsquo;Jim&rsquo;, null);</p>
<h4 id="-地址符">“&amp;” 地址符：</h4>
<p>l 在insert语句中使用&amp;可以让用户输入值:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> emp(empno, ename, sal, deptno) <span style="color:#66d9ef">values</span>(<span style="color:#f92672">&amp;</span>empno, <span style="color:#f92672">&amp;</span>ename, <span style="color:#f92672">&amp;</span>sal, <span style="color:#f92672">&amp;</span>deptno);  
</span></span></code></pre></div><p>理论上“&amp;”后面的变量名任意，习惯上一般与前面的列名相同，赋值的时候清楚在给谁赋值。</p>
<p>当再次需要插入新员工的时候直接输入“/”就可以继续输入新员工的值, /表示重复刚刚执行过的sql语句.</p>
<p>l 可以在DML的任意一个语句中输入“&amp;”,</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">&amp;</span>t
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp ; 
</span></span></code></pre></div><p>执行时，会提示你输入要查询的列名。当输入不同的列名时，显示不同的执行结果。</p>
<p><code>select * from &amp;t;</code>  修改t的值，可以查看不同表。</p>
<p>总结: &amp;类似于c语言中的宏替换, 只是进行简单的字符串替换操作, 但是select关键字不能用&amp;指代. 如 &amp;t * from emp; 而from, 表名, where 是可以用&amp;指代的, 如: <code>select * &amp;t emp; select * from &amp;t; select * from emp &amp;t sal&gt;2000;</code>但是通常情况都是替换值.</p>
<h4 id="批处理">批处理：</h4>
<p>一次插入多条数据, 使用一个新创建的表用来测试.</p>
<p>创建一张与emp完全相同的表，用于测试。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> emp10 ASSELECT <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> tab;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">desc</span> emp10;
</span></span></code></pre></div><p>一次性将emp表中所有10号部门的员工, 放到新表emp10中来。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> emp10SELECT <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>;
</span></span></code></pre></div><p>一次性将emp表中的指定列插入到表emp10中。</p>
<pre><code>注意：insert的列名, 要和select的列名一致
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> emp10(empno, ename, sal, deptno); 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         sal,
</span></span><span style="display:flex;"><span>         deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>;
</span></span></code></pre></div><p>注意没有values关键字了, 但列名必须一一对应.</p>
<p>总结: 子查询可以出现在DML的任何语句中.</p>
<h4 id="更新数据update">更新数据update</h4>
<p>格式: update 表名 set col=值 where condtion</p>
<p>对于更新操作来说，一般会有一个“where”条件，如果没有这限制条件，更新的就是整张表。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">UPDATE</span> emp10 <span style="color:#66d9ef">SET</span> sal<span style="color:#f92672">=</span><span style="color:#ae81ff">4000</span>,
</span></span><span style="display:flex;"><span>         comm<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> ename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;CLARK&#39;</span>;
</span></span></code></pre></div><p>注意：若没有where限定，会将所有的员工的sal都设置成4000，comm设置成300；</p>
<p>能否将某一列的值设置为null呢?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">UPDATE</span> emp10 <span style="color:#66d9ef">SET</span> comm <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> empno<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>; <span style="color:#f92672">#</span> <span style="color:#75715e">----可以
</span></span></span></code></pre></div><p>能否在查询的时候where条件中指定列的值为null吗?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> comm <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>; <span style="color:#f92672">#</span> <span style="color:#75715e">----不可以
</span></span></span></code></pre></div><h2 id="10-删除数据delete">10 删除数据delete</h2>
<p>格式: delete from 表名 where condtion</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">delete</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp10
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> empno<span style="color:#f92672">=</span><span style="color:#ae81ff">7782</span>;
</span></span></code></pre></div><p>注意: 如不加&quot;where&quot;会将整张表的数据删除。</p>
<pre><code> “from”关键字在Oracle中可以省略不写，但MySQL中不可以;
</code></pre>
<p>但在使用的时候建议还是加上from.</p>
<h3 id="delete-和-truncate的区别">delete 和 truncate的区别：</h3>
<ol>
<li>
<p>delete 逐条删除表“内容”，<code>truncate</code> 先摧毁表再重建。</p>
<p>(由于delete使用频繁，Oracle对delete优化后delete快于truncate)</p>
</li>
<li>
<p>delete 是DML语句，truncate 是DDL语句。</p>
<p>DML语句可以闪回(flashback)，DDL语句不可以闪回。</p>
</li>
</ol>
<p>（闪回： 做错了一个操作并且commit了，对应的撤销行为。了解）</p>
<ol start="3">
<li>
<p>由于delete是逐条操作数据，所以delete会产生碎片，truncate不会产生碎片。</p>
<p>（同样是由于Oracle对delete进行了优化，让delete不产生碎片）。</p>
<p>两个数据之间的数据被删除，删除的数据——碎片，整理碎片，数据连续，行移动</p>
</li>
<li>
<p>delete不会释放空间，truncate 会释放空间</p>
<p>用delete删除一张10M的表，空间不会释放。而truncate会。所以当确定表不再</p>
</li>
</ol>
<p>使用，应truncate</p>
<ol start="5">
<li>delete可以回滚rollback, truncate不可以回滚rollback。</li>
</ol>
<h3 id="delete和truncate的时效性">delete和truncate的时效性</h3>
<p>【做实验sql.sql】：验证delete和truncate的时效性。	终端里@c:\sql.sql	可以执行脚本sql.sql</p>
<pre><code>语句执行时间记录开关：set timing on/off

			回显开关：set feedback on/off

【测试步骤】：	

				1. 关闭开关：					SQL&gt; set timing off;															SQL&gt; set feedback off;  

				2. 使用脚本创建表：			SQL&gt; @c:\sql.sql  

				3. 打开时间开关：			SQL&gt; `set timing on; ` 

				4. 使用delete删除表内容：	SQL&gt; `delete from testdelete; ` 

				5. 删除表：			   SQL&gt;`drop table testdelete purge;`  

				6. 关闭时间开关：			SQL&gt; `set timing off;`  

				7. 使用脚本创建表：			SQL&gt; `@c:\sql.sql ` 

				8. 打开时间开关：			SQL&gt; `set timing on;  `

				9. 使用truncate删除表内容：	SQL&gt; `truncate table testdelete;`  
</code></pre>
<h3 id="事务">事务</h3>
<p>联想现实生活中的银行转账业务, 从A账户把钱转给B账户.</p>
<p>数据库事务，是由有限的数据库操作序列组成的逻辑执行单元，这一系列操作要么全部执行，要么全部放弃执行。</p>
<p>n 数据库事务由以下的部分组成:</p>
<p><strong>Ø</strong> 一个或多个DML 语句</p>
<p>Ø 一个 DDL(Data Definition Language – 数据定义语言) 语句</p>
<p>Ø 一个 DCL(Data Control Language – 数据控制语言) 语句</p>
<p>事务的特点：要么都成功，要么都失败。</p>
<h4 id="事务的特性">事务的特性</h4>
<p>l 事务4大特性(ACID) ：原子性、一致性、隔离性、持久性。</p>
<p>原子性 (Atomicity)：事务中的全部操作在数据库中是不可分割的，要么全部完成，要么均不执行。</p>
<p>一致性 (Consistency)：几个并行执行的事务, 其执行结果必须与按某一顺序串行执行的结果相一致。</p>
<p>隔离性 (Isolation)：事务的执行不受其他事务的干扰，当数据库被多个客户端并发访问时，隔离它们的操作，防止出现：脏读、幻读、不可重复读。</p>
<p>持久性 (Durability)：对于任意已提交事务，系统必须保证该事务对数据库的改变不被丢失，即使数据库出现故障。</p>
<p>事务的起始标志：oracle中自动开启事务，以DML语句为开启标志。</p>
<p>执行一个增删改查语句, 只要没有提交commit和回滚rollback, 操作都在一个事务中.</p>
<p>事务的结束标志: 提交、回滚都是事务的结束标志。</p>
<p>提交:</p>
<p>Ø 显示提交: commit</p>
<p>Ø 隐式提交</p>
<ol>
<li>有DDL语句，如：create table除了创建表之外还会隐式提交Create</li>
</ol>
<p>之前所有没有提交的DML语句。</p>
<ol start="2">
<li>正常退出(exit / quit)</li>
</ol>
<p>u 回滚:</p>
<p>Ø 显示回滚: <code>rollback</code></p>
<p>Ø 隐式回滚: 掉电、宕机、非正常退出。</p>
<h4 id="控制事务">控制事务</h4>
<p>l 保存点（savepoint）可以防止错误操作影响整个事务，方便进行事务控制。</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps11.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps11.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<p>【示例】：1. <code>create table testsp ( tid number, tname varchar2(20)); </code></p>
<p>DDL语句会隐式commit之前操作.</p>
<pre><code>	 2. `set feedback on; `   	打开回显

	 3. `insert into testsp values(1, 'Tom');`

	 4. `insert into testsp values(2, 'Mary');`

	 5. `savepoint aaa;`

	 6. `insert into testsp values(3, 'Moke');`		故意将“Mike”错写成“Moke”。

	 7. `select * from testsp; `				三条数据都显示出来。

	 8.` rollback to savepoint aaa;`				回滚到保存点aaa

	 9. `select * from testsp;` 					发现表中的数据保存到第二条操作结束的位置
</code></pre>
<p>需要注意，前两次的操作仍然没有提交。如操作完成应该显示的执行 commit 提交。</p>
<p>savepoint主要用于在事务上下文中声明一个中间标记, 将一个长事务分隔为多个较小的部分, 和我们编写文档时, 习惯性保存一下一样, 都是为了防止出错和丢失。如果保存点设置名称重复，则会删除之前的那个保存点。一但commit之后，所有的savepoint将失效。</p>
<h4 id="隔离级别">隔离级别</h4>
<p>对于同时运行的多个事务, 当这些事务访问数据库中相同的数据时, 如果没有采取必要的隔离机制, 就会导致各种并发问题:</p>
<p>脏读: 对于两个事物T1, T2, T1读取了已经被T2更新但还没有被提交的字段. 之后, 若 T2 回滚, T1读取的内容就是临时且无效的</p>
<p>不可重复读: 对于两个事物 T1, T2, T1 读取了一个字段, 然后 T2 更新了该字段. 之后, T1再次读取同一个字段, 值就不同了.</p>
<p>幻读: 对于两个事物 T1, T2, T1 从一个表中读取了一个字段, 然后 T2 在该表中插入了一些新的行. 之后, 如果 T1 再次读取同一个表, 就会多出几行.</p>
<p>数据库事务的隔离性: 数据库系统必须具有隔离并发运行各个事务的能力, 使它们不会相互影响, 避免各种并发问题.</p>
<p>一个事务与其他事务隔离的程度称为隔离级别. 数据库规定了多种事务隔离级别, 不同隔离级别对应不同的干扰程度, 隔离级别越高, 数据一致性就越好, 但并发性越弱.</p>
<p>​</p>
<p>SQL99定义4中隔离级别：</p>
<ol>
<li>
<p><code>Read Uncommitted</code>	 读未提交数据。</p>
</li>
<li>
<p><code>Read Commited</code>	 读已提交数据。	（Oracle默认）</p>
</li>
<li>
<p><code>Repeatable Read</code>	 可重复读。		（MySQL默认）</p>
</li>
<li>
<p><code>Serializable</code>		 序列化、串行化。 （查询也要等前一个事务结束）</p>
</li>
</ol>
<p>Oracle支持的隔离级别： Read Commited（默认）和 Serializable，以及Oracle自定义的Read Only三种。</p>
<p>Read Only：由于大多数情况下，在事务操作的过程中，不希望别人也来操作，但是如果将别人的隔离级别设置为Serializable（串行），但是单线程会导致数据库的性能太差。是应该允许别人来进行read操作的。</p>
<h2 id="11-创建和管理表">11 创建和管理表</h2>
<h3 id="常见的数据库对象">常见的数据库对象</h3>
<p>数据库的对象: 经常使用的数据库对象有 表、视图、索引、序列、同义词等.</p>
<p>表		基本的数据存储集合，由行和列组成。</p>
<p>视图		从表中抽出的逻辑上相关的数据集合。</p>
<p>序列		提供有规律的数值。</p>
<p>索引		提高查询的效率</p>
<p>同义词	给对象起别名</p>
<h3 id="表的基本操作">表的基本操作</h3>
<p>基本的数据存储集合，由行和列组成。表名和列名遵循如下命名规则：</p>
<p>必须以字母开头</p>
<p>必须在 1–30 个字符之间</p>
<p>必须只能包含 A–Z, a–z, 0–9, _, $, 和 #</p>
<p>必须不能和用户定义的其他对象重名</p>
<p>必须不能是Oracle 的保留字</p>
<p>Oracle默认存储是都存为大写</p>
<p>数据库名只能是1~8位, datalink可以是128位, 和其他一些特殊字符</p>
<h4 id="创建表">创建表</h4>
<p>创建一张表必须具备：1. Create Table的权限 2. 存储空间。我们使用的scott/hr用户都具备这两点。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> test1 (tid number, tname varchar2(<span style="color:#ae81ff">20</span>), hiredate date <span style="color:#66d9ef">default</span> sysdate);
</span></span></code></pre></div><p>default的作用是, 当向表中插入数据的时候, 没有指定时间的时候, 使用默认值<code>sysdate</code>。<code>insert into test1(tid, tname) values(11, 'wangwu');</code></p>
<p>插入时没有指定Hiredate列，取当前时间。</p>
<p>创建表时， 列所使用的数据类型：</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps12.png" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps12.png"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>rowid：行地址 ——伪列</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> rowid,
</span></span><span style="display:flex;"><span>         empno,
</span></span><span style="display:flex;"><span>         deptno
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp;
</span></span></code></pre></div><p>看到该列存储的是一系列的地址(指针), 创建索引用.</p>
<p>分析，之前我们使用过的创建表的语句：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> emp10 ASSELECT <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>;
</span></span></code></pre></div><p>在这条语句中，“where 1=2”一定为假。所以是不能select到结果的，但是将这条子查询放到Create语句中，可以完成拷贝表结构的效果。最终emp10和emp有相同的结构。</p>
<p>如果, “where”给定的是一个有效的条件, 就会在创建表的同时拷贝数据。如:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> emp20 ASSELECT <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>;
</span></span></code></pre></div><p>这样emp20在创建之初就有5条数据。</p>
<p>创建一张表，要求包含：员工号 姓名 月薪 年薪 年收入 部门名称</p>
<p>分析：[员工号 姓名 月薪 年薪 年收入]在emp表中, 部门名称在dept表中, 两个表是通过deptno部门编号联系起来的.</p>
<p>根据要求，涉及emp和dept两张表(至少有一个where条件)，并且要使用表达式来计算年收入和年薪。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> empincome <span style="color:#66d9ef">AS</span> <span style="color:#960050;background-color:#1e0010">↓</span><span style="color:#66d9ef">SELECT</span> e.empno,
</span></span><span style="display:flex;"><span>         e.ename,
</span></span><span style="display:flex;"><span>         e.sal,
</span></span><span style="display:flex;"><span>         e.sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span> annualsal,
</span></span><span style="display:flex;"><span>         e.sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span><span style="color:#f92672">+</span>nvl(comm,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">0</span>) income,
</span></span><span style="display:flex;"><span>         d.dname
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, dept d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.deptno <span style="color:#f92672">=</span> d.deptno;
</span></span></code></pre></div><pre><code>必须要给表达式取别名(语法要求) 
</code></pre>
<p>由于此时的“where”条件是有效的条件，就会在创建表的同时拷贝数据。</p>
<p>创建“视图”的语法与上边表的语法、顺序几乎完全一样，只是将“table”→“view”即可。</p>
<h4 id="修改表">修改表</h4>
<p>ALTER TABLE</p>
<p>追加一列: 向test1表中加入新列 image 类型是blob</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span> test1 <span style="color:#66d9ef">add</span> image blob;  		 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">desc</span> test1;
</span></span></code></pre></div><p>修改一列: 将tname列的大小有20→40.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span> test1 <span style="color:#66d9ef">modify</span> tname varchar2(<span style="color:#ae81ff">40</span>);
</span></span></code></pre></div><p>删除一列: 将刚加入的新列image删除.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span> test1 <span style="color:#66d9ef">drop</span> <span style="color:#66d9ef">column</span> image;
</span></span></code></pre></div><p>重命名一列: 将列tname重命名为username.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span> test1 <span style="color:#66d9ef">rename</span> <span style="color:#66d9ef">column</span> tname <span style="color:#66d9ef">to</span> username;	
</span></span></code></pre></div><p>注意: 若是修改表的字段的长度, 若是增加长度没有问题, 若是减少字段的长度, 有可能会报错.</p>
<h4 id="删除表">删除表</h4>
<p>当表被删除：</p>
<p>数据和结构都被删除</p>
<p>所有正在运行的相关事物被提交</p>
<p>所有相关索引被删除</p>
<p><code>DROP TABLE</code> 语句不能回滚，但是可以闪回</p>
<p><code>select * from tab;</code>  	查看当前用户下有哪些表, 拷贝保存表名。</p>
<p><code>drop table testsp; </code> 	将测试保存点的表删除。</p>
<p><code>select * from tab;</code>  	再次查询跟刚刚保存的表名比对，少了testsp，但多了另外一张命名复杂的表。</p>
<p>Oracle的回收站：</p>
<ol>
<li>查看回收站：show recyclebin (sqlplus 命令)那个复杂的命名即是testsp在回收站中的名字。</li>
</ol>
<p><code>select * from testsp;</code> 这样是不能访问的。</p>
<p>select * from &ldquo;BIN$+vu2thd8TiaX5pA3GKHsng==$0&rdquo;  要使用“回收站中的名字”</p>
<ol start="2">
<li>
<p>清空回收站：<code>purge recyclebin</code></p>
<p><code>drop table test1 purge</code> 		表示直接删除表，不经过回收站。</p>
<p>将表从回收站里恢复，涉及“闪回”的知识，作为了解性知识点。</p>
</li>
</ol>
<p>将表从回收站闪回</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>flashback <span style="color:#66d9ef">table</span> t2 <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">before</span> <span style="color:#66d9ef">drop</span>;
</span></span></code></pre></div><p>清空回收站</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>purge recyclebin;
</span></span></code></pre></div><p>注意：并不是所有的用户都有“回收站”，对于没有回收站的用户（管理员）来说，删除操作是不可逆的.</p>
<h4 id="重命名表">重命名表</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">rename</span> test1 <span style="color:#66d9ef">to</span> test8;						  
</span></span></code></pre></div><p>Truncate Table：DDL语句		——注意：不能回滚(rollback)</p>
<h3 id="约束">约束：</h3>
<h4 id="约束的种类">约束的种类</h4>
<ol>
<li>
<p><code>Not Null</code>		非空约束</p>
<pre><code>例如：人的名字，不允许为空。
</code></pre>
</li>
<li>
<p><code>Unique</code>		唯一性约束</p>
<pre><code>例如：电子邮件地址，不可以重复。
</code></pre>
</li>
<li>
<p><code>Primary Key</code>	主键约束</p>
<pre><code>通过这个列的值可以唯一的确认一行记录，主键约束隐含Not null + Unique
</code></pre>
</li>
<li>
<p><code>Foreign Key</code>	外键约束</p>
<p>​</p>
</li>
</ol>
<p>例如：部门表dept和员工表emp，不应该存在不属于任何一个部门的员工。用来约束两张表的关系。</p>
<p>注意：如果父表的记录被子表引用的话，父表的记录默认不能删除。解决方法：</p>
<pre><code>1）	先将子表的内容删除，然后在删除父表。

2）	将子表外键一列设置为NULL值，断开引用关系，然后删除父表。
</code></pre>
<p>无论哪种方法，都要在两个表进行操作。所以定义外键时，可以通过references指定如下参数：</p>
<p>ON DELETE CASCADE：当删除父表时，如发现父表内容被子表引用，级联删除子表引用记录。</p>
<p>ON DELETE SET NULL：当发现上述情况，先把子表中对应外键值置空，再删除父表。</p>
<p>多数情况下，使用SET NULL方法，防止子表列被删除，数据出错。</p>
<ol start="5">
<li>
<p>Check检查性约束</p>
<pre><code>如：教室中所有人的性别；工作后薪水满足的条件。
</code></pre>
</li>
</ol>
<p>新建一个测试表: test7</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> test7 
</span></span><span style="display:flex;"><span>	  (tid number,  
</span></span><span style="display:flex;"><span>		tname varchar2(<span style="color:#ae81ff">20</span>),  
</span></span><span style="display:flex;"><span>		gender varchar(<span style="color:#ae81ff">6</span>) <span style="color:#66d9ef">check</span> (gender <span style="color:#66d9ef">in</span> (<span style="color:#e6db74">&#39;男&#39;</span>, <span style="color:#e6db74">&#39;女&#39;</span>)),		
</span></span><span style="display:flex;"><span>		sal number <span style="color:#66d9ef">check</span> (sal <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>)										
</span></span><span style="display:flex;"><span>	  ); 			
</span></span></code></pre></div><p>说明:</p>
<p>check (gender in (&lsquo;男&rsquo;, &lsquo;女&rsquo;)) 检查插入的性别是不是‘男’或‘女’（单引号）。</p>
<pre><code>	 check (sal &gt; 0)	检查薪水必须是一个正数。
</code></pre>
<p>测试: <code>insert into test7 values(1, 'Tom', '男', 1000); </code> 没有问题.</p>
<p>如果插入: insert into test7 values(2, &lsquo;Mary&rsquo;, &lsquo;啊&rsquo;, 2000);  会报错.</p>
<p>ORA-02290：违反检查约束条件SCOTT.SYS_C005523,  gender的值只能取’男’或者’女’.</p>
<p>其中的“SYS_C005523”是约束的名字，由于在定义约束时没有显式指定，系统默认给起了这样一个名称。所以我们建议，创建约束的时候，自定义一个见名知意的约束名。</p>
<p>constraint: 使用该关键字，来给约束起别名。</p>
<h4 id="约束举例">约束举例</h4>
<p>【约束举例】：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> student 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	(
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		sid number <span style="color:#66d9ef">constraint</span> student_PK <span style="color:#66d9ef">primary</span> <span style="color:#66d9ef">key</span>,  		   <span style="color:#f92672">#</span> <span style="color:#75715e">--学生Id主键约束
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		sname varchar2(<span style="color:#ae81ff">20</span>) <span style="color:#66d9ef">constraint</span> student_name_notnull <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">null</span>, 	<span style="color:#f92672">#</span> <span style="color:#75715e">--学生姓名非空约束
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		email varchar2(<span style="color:#ae81ff">20</span>) <span style="color:#66d9ef">constraint</span> student_email_unique <span style="color:#66d9ef">unique</span>		<span style="color:#f92672">#</span> <span style="color:#75715e">--学生邮件唯一约束
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>					 <span style="color:#66d9ef">constraint</span> student_email_notnull <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">null</span>,	   <span style="color:#f92672">#</span> <span style="color:#75715e">--同时邮件可再设非空，没有,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		age number <span style="color:#66d9ef">constraint</span> student_age_min <span style="color:#66d9ef">check</span>(age <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">10</span>),	   <span style="color:#f92672">#</span> <span style="color:#75715e">--学生年龄设置check约束
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		gender varchar2(<span style="color:#ae81ff">6</span>) <span style="color:#66d9ef">constraint</span> gender_female_or_male <span style="color:#66d9ef">check</span>(gender <span style="color:#66d9ef">in</span> (<span style="color:#e6db74">&#39;男&#39;</span>, <span style="color:#e6db74">&#39;女&#39;</span>)),
</span></span><span style="display:flex;"><span>		deptno number <span style="color:#66d9ef">constraint</span> student_FK <span style="color:#66d9ef">references</span> dept (deptno) <span style="color:#66d9ef">ON</span> <span style="color:#66d9ef">DELETE</span> <span style="color:#66d9ef">SET</span> <span style="color:#66d9ef">NULL</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	);
</span></span></code></pre></div><p>在定义学生deptno列的时候，引用部门表的部门号一列作为外键，同时使用references设置级联操作</p>
<pre><code>——当删除dept表的deptno的时候，将student表的deptno置空。
</code></pre>
<p>查看student表各列的约束</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">desc</span> student;
</span></span></code></pre></div><p>student的建表语句:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> dbms_metadata.get_ddl(<span style="color:#e6db74">&#39;TABLE&#39;</span>, <span style="color:#e6db74">&#39;STUDENT&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> dual;
</span></span></code></pre></div><p>测试用例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> student <span style="color:#66d9ef">values</span>(<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;Tom&#39;</span>, <span style="color:#e6db74">&#39;tom@126.com&#39;</span>, <span style="color:#ae81ff">20</span>, <span style="color:#e6db74">&#39;男&#39;</span>, <span style="color:#ae81ff">10</span>);  <span style="color:#f92672">#</span> <span style="color:#960050;background-color:#1e0010">正确插入表数据。</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> student <span style="color:#66d9ef">values</span>(<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;Tom&#39;</span>, <span style="color:#e6db74">&#39;tom@126.com&#39;</span>, <span style="color:#ae81ff">15</span>, <span style="color:#e6db74">&#39;男&#39;</span>, <span style="color:#ae81ff">10</span>);
</span></span></code></pre></div><pre><code>	违反student_email_unique约束。
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> student <span style="color:#66d9ef">values</span>(<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;Tom3&#39;</span>, <span style="color:#e6db74">&#39;tom3@126.com&#39;</span>, <span style="color:#ae81ff">14</span>, <span style="color:#e6db74">&#39;男&#39;</span>,<span style="color:#ae81ff">100</span> );
</span></span></code></pre></div><pre><code>  违反完整约束条件 (SCOTT.STUDENT_FK) - 未找到父项关键字
</code></pre>
<p>问题：是不是父表的所有列，都可以设置为子表的外键？作外键有要求吗？</p>
<pre><code>外键：必须是父表的主键.
</code></pre>
<p>查看指定表（如student）的约束, 注意表名必须大写。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">constraint_name</span>,
</span></span><span style="display:flex;"><span>         constraint_Type,
</span></span><span style="display:flex;"><span>         search_condition
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> user_constraints
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">table_name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;STUDENT&#39;</span>; 
</span></span></code></pre></div><h2 id="12-其它数据库对象">12 其它数据库对象</h2>
<h3 id="视图">视图：</h3>
<p>视图是一种常见数据库对象, 它是从表中抽出的逻辑上相关的数据集合。</p>
<p>所以：1. 视图基于表。2. 视图是逻辑概念。3. 视图本身没有数据。</p>
<h4 id="创建视图">创建视图</h4>
<p>创建语法与创建表类似，只需要将table → view即可:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">view</span> empincomeview ASSELECT e.empno,
</span></span><span style="display:flex;"><span>         e.ename,
</span></span><span style="display:flex;"><span>         e.sal,
</span></span><span style="display:flex;"><span>         e.sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span> annualsal,
</span></span><span style="display:flex;"><span>         e.sal<span style="color:#f92672">*</span><span style="color:#ae81ff">12</span><span style="color:#f92672">+</span>nvl(comm,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">0</span>) income,
</span></span><span style="display:flex;"><span>         d.dname
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, dept d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.deptno <span style="color:#f92672">=</span> d.deptno;
</span></span></code></pre></div><pre><code>出错提示：权限不足。因为创建视图需要“create view”的权限。默认scott用户没有该种权限。加之！
</code></pre>
<p>添加步骤：</p>
<ol>
<li>
<p>使用管理员登陆：<code>sqlplus / as sysdba</code></p>
</li>
<li>
<p>给scott用户增加权限</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">grant</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">to</span> scott;
</span></span></code></pre></div></li>
<li>
<p>执行“/”可成功创建视图empincomeview.</p>
</li>
<li>
<p>视图的操作和表的操作完全一样.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> empincomeview;
</span></span></code></pre></div><h4 id="视图的优点">视图的优点：</h4>
<p>视图的优点</p>
<ol>
<li>
<p>简化复杂查询: 原来分组、多表、子查询等可以用一条select * from xxxview代替,视图可以看做是表的复杂的SQL一种封装。</p>
</li>
<li>
<p>限制数据访问: 只看视图的结构和数据是无法清楚视图是怎样得来的。可以限制数据的访问。例如：银行项目，所谓的各个“表”都是“视图”，并有可能只是“只读视图”</p>
</li>
</ol>
<p>注意：1. 视图不能提高性能 		2. 不建议通过视图对表进行修改。</p>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps13.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps13.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<h4 id="创建视图细节">创建视图细节：</h4>
<p>使用下面的语法格式创建视图：</p>
<p><strong>CREATE [OR REPLACE] [FORCE|NOFORCE] VIEW view</strong></p>
<hr>
<p><strong>[(alias[, alias]&hellip;)]</strong></p>
<p><strong>AS subquery</strong></p>
<p><strong>[WITH CHECK OPTION [CONSTRAINT constraint]]</strong></p>
<p><strong>[WITH READ ONLY [CONSTRAINT constraint]];</strong></p>
<ol>
<li>
<p>视图只能创建、删除、替换。（不能修改，修改即替换replace）</p>
<p>如：刚刚创建的<strong>empincomeview</strong>，其他语句不变，将create一行改写成：</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#f92672">#</span> <span style="color:#960050;background-color:#1e0010">视图不存在则创建、存在则替换。</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">OR</span> <span style="color:#66d9ef">replace</span> <span style="color:#66d9ef">view</span> empincomeview <span style="color:#66d9ef">AS</span> <span style="color:#66d9ef">select</span><span style="color:#960050;background-color:#1e0010">……</span> <span style="color:#66d9ef">from</span><span style="color:#960050;background-color:#1e0010">…</span>..<span style="color:#66d9ef">where</span><span style="color:#960050;background-color:#1e0010">…</span>..
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WITH</span> <span style="color:#66d9ef">read</span> <span style="color:#66d9ef">only</span>; <span style="color:#f92672">#</span> <span style="color:#960050;background-color:#1e0010">可以将视图设为只读视图。</span>
</span></span></code></pre></div><ol start="2">
<li>
<p>别名: 可以写在子查询select各个列的后面，也可以写在视图的名字后面。</p>
</li>
<li>
<p><code>with read only</code>  表示该视图为只读视图。</p>
</li>
<li>
<p><code>with check option</code>	了解即可， 举例：</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">view</span> testview ASSELECT <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> deptno<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WITH</span> <span style="color:#66d9ef">check</span> <span style="color:#66d9ef">option</span>;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> testview <span style="color:#66d9ef">values</span>(<span style="color:#f92672">******</span>, <span style="color:#ae81ff">10</span>);
</span></span></code></pre></div><p>不建议向视图插入，但可以做。向视图插入10号员工。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> testview <span style="color:#66d9ef">values</span>(<span style="color:#f92672">******</span>, <span style="color:#ae81ff">20</span>);
</span></span></code></pre></div><p>因为创建视图时加了“with check option”，所以失败。</p>
<p>视图中使用DML的规定：</p>
<p>一：</p>
<p>当视图定义中包含以下元素之一时不能使用delete:</p>
<ul>
<li>
<p>组函数</p>
</li>
<li>
<p>GROUP BY 子句</p>
</li>
<li>
<p>DISTINCT 关键字</p>
</li>
<li>
<p>ROWNUM 伪列</p>
</li>
</ul>
<p>二：</p>
<pre><code>当视图定义中包含以下元素之一时不能使用update :
</code></pre>
<ul>
<li>
<p>组函数</p>
</li>
<li>
<p>GROUP BY子句</p>
</li>
<li>
<p>DISTINCT 关键字</p>
</li>
<li>
<p>ROWNUM 伪列</p>
</li>
<li>
<p>列的定义为表达式</p>
</li>
</ul>
<p>三：</p>
<pre><code>当视图定义中包含以下元素之一时不能使用insert :
</code></pre>
<ul>
<li>
<p>组函数</p>
</li>
<li>
<p>GROUP BY 子句</p>
</li>
<li>
<p>DISTINCT 关键字</p>
</li>
<li>
<p>ROWNUM 伪列</p>
</li>
<li>
<p>列的定义为表达式</p>
</li>
<li>
<p>表中非空的列在视图定义中未包括</p>
</li>
</ul>
<p>总结一句话：<strong>不通过视图做insert、update、delete操作。因为视图提供的目的就是为了简化查询。</strong></p>
<p>删除视图:</p>
<p><code>drop view testview;</code> &mdash;&mdash;à不加“purge”关键字。</p>
<h3 id="序列">序列：</h3>
<p>可以理解成数组：默认，从[1]开始，长度[20]		[1, 2, 3, 4, 5, 6, …, 20]		在内存中。</p>
<p>由于序列是被保存在内存中，访问内存的速率要高于访问硬盘的速率。所以序列可以提高效率。</p>
<h4 id="序列的使用">序列的使用：</h4>
<ol>
<li>
<p>初始状态下：指针<em>指向1前面的位置。欲取出第一个值，应该将</em>向后移动。每取出一个值指针都向后移。</p>
</li>
<li>
<p>常常用序列来指定表中的主键。</p>
</li>
<li>
<p>创建序列：create sequence myseq  来创建一个序列。</p>
<p>​</p>
</li>
</ol>
<p>创建序列：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> SEQUENCE sequence
</span></span><span style="display:flex;"><span>    [<span style="color:#66d9ef">INCREMENT</span> <span style="color:#66d9ef">BY</span> n]
</span></span><span style="display:flex;"><span>    [<span style="color:#66d9ef">START</span> <span style="color:#66d9ef">WITH</span> n]
</span></span><span style="display:flex;"><span>    [<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#66d9ef">MAXVALUE</span> n <span style="color:#f92672">|</span> NOMAXVALUE<span style="color:#960050;background-color:#1e0010">}</span>]
</span></span><span style="display:flex;"><span>    [<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#66d9ef">MINVALUE</span> n <span style="color:#f92672">|</span> NOMINVALUE<span style="color:#960050;background-color:#1e0010">}</span>]
</span></span><span style="display:flex;"><span>    [<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#66d9ef">CYCLE</span> <span style="color:#f92672">|</span> NOCYCLE<span style="color:#960050;background-color:#1e0010">}</span>]
</span></span><span style="display:flex;"><span>    [<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#66d9ef">CACHE</span> n <span style="color:#f92672">|</span> NOCACHE<span style="color:#960050;background-color:#1e0010">}</span>];
</span></span></code></pre></div><p>NOCACHE表示没有缓存，一次不产生20个，而只产生一个。</p>
<h4 id="创建序列">创建序列</h4>
<p>创建序列、表，以备后续测试使用：</p>
<pre><code>`create sequence myseq;` 				按默认属性创建一个序列。
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> tableA (tid number, tname varchar2(<span style="color:#ae81ff">20</span>)); 
</span></span></code></pre></div><p>tid作为主键，准备使用序列来向表中插入值。</p>
<h4 id="序列的属性">序列的属性：</h4>
<p>每个序列都有两个属性, nextval和currval.</p>
<p><strong>NextVal 必须在CurrVal之前被指定</strong>。因为初始状态下，CurrVal指向1前面的位置，无值</p>
<p>对于新创建的序列使用<code>select myseq.currval from dual; </code> 		得到出错。</p>
<p>但<code>select myseq.nextval from dual;</code>  		可以得到序列的第一值1.</p>
<p>此时再执行<code>select myseq.currval from dual;</code>    	currval的值也得到1</p>
<p>使用序列给tableA表创建主键tid：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> tableA <span style="color:#66d9ef">values</span>(myseq.nextval, <span style="color:#960050;background-color:#1e0010">‘</span>aaa<span style="color:#960050;background-color:#1e0010">’</span>)   
</span></span></code></pre></div><pre><code>只有nextval取完会向后移动，使用currval不会移动。
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> tableA <span style="color:#66d9ef">values</span>(myseq.nextval, <span style="color:#960050;background-color:#1e0010">‘</span>bbb<span style="color:#960050;background-color:#1e0010">’</span>)  
</span></span></code></pre></div><pre><code>继续使用nextval向表中添加主键tid
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> tableA <span style="color:#66d9ef">values</span>(myseq.nextval, <span style="color:#f92672">&amp;</span>name) 
</span></span></code></pre></div><pre><code>可以使用“&amp;”和“/”来指定名字。
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> tableA; 
</span></span></code></pre></div><p>由于前面测试currval和nextval关系时调用过nextval，所以tableA的tid起始从2开始。</p>
<p>查询序列的属性：``select * from user_sequences;<code>  </code>user_sequences`为数据字典视图。</p>
<p>修改序列：</p>
<ul>
<li>
<p>必须是序列的拥有者或对序列有 ALTER 权限</p>
</li>
<li>
<p>只有将来的序列值会被改变</p>
</li>
<li>
<p>改变序列的初始值只能通过删除序列之后重建序列的方法实现</p>
</li>
</ul>
<p>删除序列：<code>drop sequence myseq;  </code></p>
<p><strong>使用序列需要注意的地方: 应首先执行nextval, 之后才能使用currval的值, 刚刚创建的序列不能直接使用currval的值.</strong></p>
<h4 id="使用序列需要注意的问题">使用序列需要注意的问题：</h4>
<ul>
<li>序列是公有对象，所以多张表同时使用序列，会造成主键不连续。	如：[1, 2, 3, 4, 5, …, 20]</li>
</ul>
<p>tableA:	1	2	4</p>
<p>tableB:	3	5				A、B表有可能主键不连续。</p>
<ul>
<li>
<p>回滚也可能造成主键不连续。	如：多次调用insert操作使用序列创建主键。但是当执行了rollback后再次使用insert借助序列创建主键的时候，nextval不会随着回滚操作回退。</p>
</li>
<li>
<p>掉电等原因，也可能造成不连续。由于代表序列的数组保存在内存中，断电的时候内存的内容丢失。恢复供电时候，序列直接从21开始。</p>
</li>
</ul>
<h3 id="索引">索引：</h3>
<p>索引，相当于书的目录，提高数据检索速度。提高效率（视图不可以提高效率）</p>
<ul>
<li>
<p><strong>一种独立于表的模式对象, 可以存储在与表不同的磁盘或表空间中</strong></p>
</li>
<li>
<p><strong>索引被删除或损坏, 不会对表产生影响, 其影响的只是查询的速度</strong></p>
</li>
<li>
<p>索引一旦建立, Oracle 管理系统会对其进行自动维护, 而且由 Oracle 管理系统决定何时使用索引. 用户不用在查询语句中指定使用哪个索引</p>
</li>
<li>
<p>在删除一个表时, 所有基于该表的索引会自动被删除</p>
</li>
<li>
<p>通过指针<strong>加速 Oracle 服务器的查询速度</strong></p>
</li>
<li>
<p>通过快速定位数据的方法，减少磁盘 I/O</p>
</li>
</ul>
<p><figure 
	>
	<a href="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps14.jpg" >
		<img src="https://gitee.com/txt1994/images/raw/master/img/Oracle/wps14.jpg"
			
			
			
			loading="lazy"
			alt="img">
	</a>
	
	<figcaption>img</figcaption>
	
</figure></p>
<p>上图中：</p>
<ol>
<li>
<p>emp表中保存数据，其中包含部门号列。有10号部门，有20部门员工</p>
</li>
<li>
<p>当 <code>select * from emp where deptno=10</code> 的时候。由于10号部门员工不连续，没规律。</p>
<p>为了提高访问速度，可以在数据库中，依照rowid给deptno列建立索引</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">index</span> myindex
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">ON</span> emp(deptno);
</span></span></code></pre></div><pre><code>	这样就建立了“索引表”可以通过rowid保存的行地址快速的找到表中数据。即使表中数据不连续。
</code></pre>
<ol start="3">
<li>
<p>建立了索引以后，如果再执行select语句的时候，会先检查表上是否有索引表。如果有，可以通过有规律的rowid找到连续的数据。</p>
</li>
<li>
<p>Oracle的数据库中，索引有 B树索引（默认）和 位图索引两种。</p>
</li>
<li>
<p>使用<code>create index 索引表名 on 表名（列名1， 列名2…）;</code>来创建索引表。由数据库自动进行维护。</p>
</li>
</ol>
<p><strong>使用主键查询数据最快速，因为主键本身就是“索引”，所以检索比较快。</strong></p>
<p>索引使用的场景：</p>
<p>以下情况可以创建索引:</p>
<ul>
<li>
<p>列中数据值分布范围很广</p>
</li>
<li>
<p>列经常在 WHERE 子句或连接条件中出现</p>
</li>
<li>
<p>表经常被访问而且数据量很大, 访问的数据大概占数据总量的2%到4%</p>
</li>
</ul>
<p>下列情况不要创建索引:</p>
<ul>
<li>
<p>表很小</p>
</li>
<li>
<p>列不经常作为连接条件或出现在WHERE子句中</p>
</li>
<li>
<p>查询的数据大于2%到4%</p>
</li>
<li>
<p>表经常更新</p>
</li>
</ul>
<p>删除索引:  <code>drop index myindex;</code></p>
<h3 id="synonym同义词">synonym同义词：</h3>
<p>就是指表的别名。</p>
<p>如：scott用户想访问hr用户下的表employees。默认是不能访问的。需要hr用户为scott用户授权.</p>
<pre><code>`sqplus hr/11		或 		conn hr/11`（已登录界面， 切换登陆）
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">grant</span> <span style="color:#66d9ef">select</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">ON</span> employees <span style="color:#66d9ef">to</span> scott; 
</span></span></code></pre></div><p>hr用户为scott用户开放了employees表的查询权限。</p>
<p>这时scott用户就可以使用select语句，来查询hr用户下的employees表的信息了。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> hr.employees;
</span></span></code></pre></div><p>​	若用户名叫zhangsanfeng则zhangsanfeng.employees</p>
<p>hr.employees名字过长，为了方便操作，scott用户为它重设别名:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> synonym hremp <span style="color:#66d9ef">for</span> hr.employees;  <span style="color:#f92672">#</span> <span style="color:#960050;background-color:#1e0010">为</span>hr.employees<span style="color:#960050;background-color:#1e0010">创建了同义词。</span>
</span></span></code></pre></div><p>如有权限限制，那么切换管理员登录，给scott用户添加设置同义词权限。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>conn / as sysdba;
</span></span><span style="display:flex;"><span>grant create synonym to scott;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">count</span>(<span style="color:#f92672">*</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> hremp;  <span style="color:#f92672">#</span> <span style="color:#960050;background-color:#1e0010">使用同义词进行表查询操作。</span>
</span></span></code></pre></div><p>同义词、视图 等用法在数据保密要求较高的机构使用广泛，如银行机构。好处是既不影响对数据的操作，同时又能保证数据的安全。</p>
<p>OCA</p>
<p>OCP</p>
<p>OCM	认证</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> rownum,
</span></span><span style="display:flex;"><span>         empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         sal
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  sal <span style="color:#66d9ef">desc</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> rownum <span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">3</span>;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> rownum rn,
</span></span><span style="display:flex;"><span>         empno,
</span></span><span style="display:flex;"><span>         ename,
</span></span><span style="display:flex;"><span>         sal
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> 
</span></span><span style="display:flex;"><span>        (<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>  sal <span style="color:#66d9ef">desc</span>) )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">WHERE</span> rn<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> rn<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">7</span>;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> d.deptno,
</span></span><span style="display:flex;"><span>         e.empno,
</span></span><span style="display:flex;"><span>         e.ename,
</span></span><span style="display:flex;"><span>         d.avgsal,
</span></span><span style="display:flex;"><span>         e.sal
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> emp e, 
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">SELECT</span> deptno,
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">avg</span>(sal) avgsal
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> emp
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>  deptno) d
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> e.deptno<span style="color:#f92672">=</span>d.deptno
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">AND</span> e.sal<span style="color:#f92672">&gt;</span>d.avgsal;
</span></span></code></pre></div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/oracle/">Oracle</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>

     
    
        
    <div class="disqus-container">
    
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 My Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#数据库介绍">数据库介绍</a></li>
    <li><a href="#1-oracle的体系结构">1 Oracle的体系结构</a>
      <ul>
        <li><a href="#11-表空间和数据文件">1.1 表空间和数据文件</a></li>
        <li><a href="#12-段区块">1.2 段、区、块</a></li>
        <li><a href="#13-dba">1.3 DBA</a></li>
        <li><a href="#14-如何启动数据库服务">1.4 如何启动数据库服务</a></li>
        <li><a href="#15-如何登陆数据库服务">1.5 如何登陆数据库服务</a></li>
        <li><a href="#16-贯穿这门课程的方案">1.6 贯穿这门课程的方案</a></li>
      </ul>
    </li>
    <li><a href="#2基本的sql-select语句">2基本的SQL select语句</a>
      <ul>
        <li><a href="#21-sqlplus的基本操作">2.1 sqlplus的基本操作</a></li>
        <li><a href="#22-基本的select语句">2.2 基本的select语句</a></li>
        <li><a href="#23-sql语句使用注意事项">2.3 SQL语句使用注意事项</a></li>
        <li><a href="#24-算数运算-----">2.4 算数运算 + - * /</a></li>
        <li><a href="#25-null值">2.5 NULL值</a></li>
        <li><a href="#26-连接符">2.6 连接符</a></li>
        <li><a href="#27-sql和sqlplus">2.7 SQL和sqlplus</a></li>
      </ul>
    </li>
    <li><a href="#3-过滤和排序数据">3 过滤和排序数据</a>
      <ul>
        <li><a href="#31-where条件过滤">3.1 where条件过滤</a></li>
      </ul>
    </li>
    <li><a href="#4-单行函数">4 单行函数</a>
      <ul>
        <li><a href="#41-字符函数">4.1 字符函数</a></li>
        <li><a href="#42-数值函数">4.2 数值函数</a></li>
        <li><a href="#43-时间函数">4.3 时间函数</a></li>
        <li><a href="#44-日期函数">4.4 日期函数</a></li>
        <li><a href="#45-转换函数">4.5 转换函数</a></li>
        <li><a href="#46-通用函数了解">4.6 通用函数(了解)</a></li>
        <li><a href="#47-条件表达式">4.7 条件表达式</a></li>
      </ul>
    </li>
    <li><a href="#5-分组函数">5 分组函数</a>
      <ul>
        <li><a href="#51分组函数">5.1分组函数</a></li>
        <li><a href="#52-分组数据">5.2 分组数据</a></li>
        <li><a href="#53-having">5.3 Having</a></li>
      </ul>
    </li>
    <li><a href="#6-多表查询">6 多表查询</a>
      <ul>
        <li><a href="#61-等值连接">6.1 等值连接：</a></li>
        <li><a href="#62-不等值连接">6.2 不等值连接：</a></li>
        <li><a href="#63-外链接">6.3 外链接：</a></li>
        <li><a href="#64-自连接">6.4 自连接：</a></li>
      </ul>
    </li>
    <li><a href="#7-子查询">7 子查询</a>
      <ul>
        <li><a href="#71-定义子查询-需要注意的问题">7.1 定义子查询 需要注意的问题</a></li>
        <li><a href="#72-主子查询在不同表间进行">7.2 主、子查询在不同表间进行。</a></li>
        <li><a href="#73-在主查询的where-select-having-from-放置子查询">7.3 在主查询的where select having from 放置子查询</a></li>
        <li><a href="#74-在from后面放置的子查询">7.4 在from后面放置的子查询(***)</a></li>
        <li><a href="#75-单行子查询只能使用单行操作符多行子查询只能使用多行操作符">7.5 单行子查询只能使用单行操作符；多行子查询只能使用多行操作符</a></li>
        <li><a href="#子查询中null">子查询中null</a></li>
        <li><a href="#一般不在子查询中使用order-by">一般不在子查询中使用order by</a></li>
        <li><a href="#一般先执行子查询再执行主查询">一般先执行子查询，再执行主查询</a></li>
      </ul>
    </li>
    <li><a href="#8-集合运算">8 集合运算</a>
      <ul>
        <li><a href="#81-集合运算符">8.1 集合运算符</a></li>
        <li><a href="#82-集合运算需要注意的问题">8.2 集合运算需要注意的问题：</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#sql语言的类型">SQL语言的类型：</a></li>
        <li><a href="#插入数据insert">插入数据insert：</a></li>
      </ul>
    </li>
    <li><a href="#10-删除数据delete">10 删除数据delete</a>
      <ul>
        <li><a href="#delete-和-truncate的区别">delete 和 truncate的区别：</a></li>
        <li><a href="#delete和truncate的时效性">delete和truncate的时效性</a></li>
        <li><a href="#事务">事务</a></li>
      </ul>
    </li>
    <li><a href="#11-创建和管理表">11 创建和管理表</a>
      <ul>
        <li><a href="#常见的数据库对象">常见的数据库对象</a></li>
        <li><a href="#表的基本操作">表的基本操作</a></li>
        <li><a href="#约束">约束：</a></li>
      </ul>
    </li>
    <li><a href="#12-其它数据库对象">12 其它数据库对象</a>
      <ul>
        <li><a href="#视图">视图：</a></li>
        <li><a href="#序列">序列：</a></li>
        <li><a href="#索引">索引：</a></li>
        <li><a href="#synonym同义词">synonym同义词：</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
